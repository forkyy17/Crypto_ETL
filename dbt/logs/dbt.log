[0m15:20:44.298200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853b7230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84997f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891b71a0>]}


============================== 15:20:44.315000 | e786529c-1ba7-4278-98d5-3f1d447622fe ==============================
[0m15:20:44.315000 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:20:44.318668 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:44.438393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e786529c-1ba7-4278-98d5-3f1d447622fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff856a2600>]}
[0m15:20:44.439871 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:20:44.442437 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:20:44.443915 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15064062, "process_user_time": 2.003758, "process_kernel_time": 0.29802, "process_mem_max_rss": "111996", "process_in_blocks": "56696", "process_out_blocks": "4923"}
[0m15:20:44.444535 [debug] [MainThread]: Command `dbt deps` succeeded at 15:20:44.444418 after 0.15 seconds
[0m15:20:44.445016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84bd6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84915520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8444bbc0>]}
[0m15:20:44.445384 [debug] [MainThread]: Flushing usage events
[0m15:20:47.171197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb46c5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59f8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4db5bb0>]}


============================== 15:20:47.177622 | d67d442b-7fd6-4802-9d8c-e65e611245c2 ==============================
[0m15:20:47.177622 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:20:47.181882 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:47.185136 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 7
    ------------------------------
    4  |     dev:
    5  |       type: clickhouse
    6  |       schema: analytics
    7  |       host: {{ env_var('CLICKHOUSE_HOST', 'clickhouse') }}
    8  |       port: {{ env_var('CLICKHOUSE_PORT', '8123') }}
    9  |       user: {{ env_var('CLICKHOUSE_USER', 'default') }}
    10 |       password: {{ env_var('CLICKHOUSE_PASSWORD', '') }}
    
    Raw Error:
    ------------------------------
    while parsing a flow mapping
      in "<unicode string>", line 7, column 14
    did not find expected ',' or '}'
      in "<unicode string>", line 7, column 55
  
[0m15:20:47.186903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.021744875, "process_user_time": 1.716084, "process_kernel_time": 0.142585, "process_mem_max_rss": "156736", "process_in_blocks": "4776", "process_out_blocks": "4", "command_success": false}
[0m15:20:47.187546 [debug] [MainThread]: Command `dbt run` failed at 15:20:47.187429 after 0.02 seconds
[0m15:20:47.188143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb59f8200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb4c21520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb481e690>]}
[0m15:20:47.188676 [debug] [MainThread]: Flushing usage events
[0m15:23:20.529561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9689d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba508200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9ef1d00>]}


============================== 15:23:20.537353 | 9787196f-db1a-44f1-b5bf-6d06bb5b9ad9 ==============================
[0m15:23:20.537353 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:23:20.538083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:23:20.644560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9787196f-db1a-44f1-b5bf-6d06bb5b9ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9689eb0>]}
[0m15:23:20.645265 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:23:20.646483 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:23:20.647513 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12990175, "process_user_time": 1.562528, "process_kernel_time": 0.226142, "process_mem_max_rss": "101500", "process_in_blocks": "58464", "process_out_blocks": "3"}
[0m15:23:20.647934 [debug] [MainThread]: Command `dbt deps` succeeded at 15:23:20.647841 after 0.13 seconds
[0m15:23:20.648214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba508200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9689eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9745460>]}
[0m15:23:20.648478 [debug] [MainThread]: Flushing usage events
[0m15:23:23.127987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7465b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa797d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7466f30>]}


============================== 15:23:23.131661 | 6b310445-0a6b-42ec-ac75-19c4d865df0e ==============================
[0m15:23:23.131661 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:23:23.132464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:23:23.135090 [error] [MainThread]: Encountered an error:
Runtime Error
  
  dbt encountered an error while trying to read your profiles.yml file.
  
  Runtime Error
    Syntax error near line 8
    ------------------------------
    5  |       type: clickhouse
    6  |       schema: analytics
    7  |       host: "{{ env_var('CLICKHOUSE_HOST', 'clickhouse') }}"
    8  |       port: {{ env_var('CLICKHOUSE_PORT', '8123') | int }}
    9  |       user: "{{ env_var('CLICKHOUSE_USER', 'default') }}"
    10 |       password: "{{ env_var('CLICKHOUSE_PASSWORD', '') }}"
    11 |       secure: false
    
    Raw Error:
    ------------------------------
    while parsing a flow mapping
      in "<unicode string>", line 8, column 14
    did not find expected ',' or '}'
      in "<unicode string>", line 8, column 49
  
[0m15:23:23.136074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.010901542, "process_user_time": 1.31071, "process_kernel_time": 0.094834, "process_mem_max_rss": "156716", "process_in_blocks": "32896", "process_out_blocks": "4", "command_success": false}
[0m15:23:23.136794 [debug] [MainThread]: Command `dbt run` failed at 15:23:23.136692 after 0.01 seconds
[0m15:23:23.137372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac08b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7bbd2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7554d70>]}
[0m15:23:23.138314 [debug] [MainThread]: Flushing usage events
[0m15:24:36.015697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac04e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d05a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b11b740>]}


============================== 15:24:36.020442 | ea44eed7-67e4-48ef-b89e-ac0fc9172f69 ==============================
[0m15:24:36.020442 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:24:36.020928 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:24:36.124229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea44eed7-67e4-48ef-b89e-ac0fc9172f69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aab3020>]}
[0m15:24:36.124883 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:24:36.125891 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:24:36.126712 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13479125, "process_user_time": 1.380669, "process_kernel_time": 0.149808, "process_mem_max_rss": "103416", "process_in_blocks": "18408", "process_out_blocks": "3"}
[0m15:24:36.127106 [debug] [MainThread]: Command `dbt deps` succeeded at 15:24:36.127017 after 0.14 seconds
[0m15:24:36.127403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2d8b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ac04350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2b19a0>]}
[0m15:24:36.127691 [debug] [MainThread]: Flushing usage events
[0m15:24:38.544121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba76570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c862cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ba742f0>]}


============================== 15:24:38.548368 | e6ce11a5-9133-4178-aa44-257d7e785b76 ==============================
[0m15:24:38.548368 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:24:38.548900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'send_anonymous_usage_stats': 'True'}
[0m15:24:38.585448 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "crypto_profile", target "dev" invalid: '8123' is not valid under any of the given schemas
[0m15:24:38.586403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.063292876, "process_user_time": 1.361417, "process_kernel_time": 0.132748, "process_mem_max_rss": "154868", "process_in_blocks": "38696", "process_out_blocks": "2", "command_success": false}
[0m15:24:38.586835 [debug] [MainThread]: Command `dbt run` failed at 15:24:38.586738 after 0.06 seconds
[0m15:24:38.587146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7bfd8710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7baf79e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7be720c0>]}
[0m15:24:38.587450 [debug] [MainThread]: Flushing usage events
[0m15:25:31.043264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83f1b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e183e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83e18f80>]}


============================== 15:25:31.048762 | 798f27f1-02f5-4e56-9eb4-a1921f729030 ==============================
[0m15:25:31.048762 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:25:31.049523 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:31.157458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '798f27f1-02f5-4e56-9eb4-a1921f729030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83ca2a80>]}
[0m15:25:31.158122 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:25:31.159470 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:25:31.160202 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13989012, "process_user_time": 1.341472, "process_kernel_time": 0.172475, "process_mem_max_rss": "103804", "process_in_blocks": "17336", "process_out_blocks": "3"}
[0m15:25:31.160620 [debug] [MainThread]: Command `dbt deps` succeeded at 15:25:31.160529 after 0.14 seconds
[0m15:25:31.160957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84d51f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff844c5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83dd5eb0>]}
[0m15:25:31.161283 [debug] [MainThread]: Flushing usage events
[0m15:25:33.527037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903d9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9282e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9117b740>]}


============================== 15:25:33.530832 | 087e78de-6904-43b4-b6d2-91ae063fe270 ==============================
[0m15:25:33.530832 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:25:33.532346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:33.608619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9093cd70>]}
[0m15:25:33.635904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff911ed280>]}
[0m15:25:33.637207 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m15:25:33.643173 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m15:25:33.643889 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:25:33.644319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90198a70>]}
[0m15:25:34.170207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff900dcad0>]}
[0m15:25:34.180231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90031a00>]}
[0m15:25:34.180693 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m15:25:34.181462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff79a00>]}
[0m15:25:34.182553 [info ] [MainThread]: 
[0m15:25:34.183309 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:25:34.184203 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:25:34.189567 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:34.889346 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:25:34.893169 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:25:34.895980 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m15:25:34.900724 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m15:25:34.982537 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.08 seconds
[0m15:25:34.989142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7959e1b0>]}
[0m15:25:34.992310 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:25:34.994268 [info ] [MainThread]: 
[0m15:25:35.005151 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m15:25:35.006022 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m15:25:35.007202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m15:25:35.007678 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m15:25:35.026669 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m15:25:35.029325 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 15:25:35.008177 => 15:25:35.028907
[0m15:25:35.030219 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m15:25:35.044784 [debug] [Thread-1 (]: Creating new relation crypto_hourly_gainers
[0m15:25:35.063089 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m15:25:35.089303 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:25:35.095784 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers'
    
      and database = 'analytics'
    
    order by position
  ...
[0m15:25:35.103398 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:25:35.105995 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m15:25:35.107597 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m15:25:35.137081 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:25:35.149497 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 15:25:35.031169 => 15:25:35.149326
[0m15:25:35.150314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '087e78de-6904-43b4-b6d2-91ae063fe270', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c155bb0>]}
[0m15:25:35.150832 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.14s]
[0m15:25:35.151864 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m15:25:35.153621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:35.153973 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m15:25:35.154439 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m15:25:35.154899 [info ] [MainThread]: 
[0m15:25:35.156178 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m15:25:35.156863 [debug] [MainThread]: Command end result
[0m15:25:35.165076 [info ] [MainThread]: 
[0m15:25:35.165860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:35.166323 [info ] [MainThread]: 
[0m15:25:35.166760 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:35.168030 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.661658, "process_user_time": 2.90882, "process_kernel_time": 0.178172, "process_mem_max_rss": "186400", "process_in_blocks": "87392", "process_out_blocks": "2593"}
[0m15:25:35.168693 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:35.168609 after 1.66 seconds
[0m15:25:35.169186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90815d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903d9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6d72e540>]}
[0m15:25:35.169521 [debug] [MainThread]: Flushing usage events
[0m15:31:09.822423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ea9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c28dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a2cacc0>]}


============================== 15:31:09.828424 | f0944777-247c-4994-8fbe-b2543a82d08f ==============================
[0m15:31:09.828424 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:31:09.832451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m15:31:09.900393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0944777-247c-4994-8fbe-b2543a82d08f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99eb12e0>]}
[0m15:31:09.901165 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:31:09.902845 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:31:09.903765 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10656, "process_user_time": 1.486472, "process_kernel_time": 0.167076, "process_mem_max_rss": "103800", "process_in_blocks": "23344", "process_out_blocks": "3"}
[0m15:31:09.904196 [debug] [MainThread]: Command `dbt deps` succeeded at 15:31:09.904102 after 0.11 seconds
[0m15:31:09.904523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ea6ed20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a78f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e66ab0>]}
[0m15:31:09.904842 [debug] [MainThread]: Flushing usage events
[0m15:31:12.165902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9061a4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9097d340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90618260>]}


============================== 15:31:12.170393 | 39248239-6b8b-4d12-916c-75fe2568ebe5 ==============================
[0m15:31:12.170393 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:31:12.171062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:31:12.254259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39248239-6b8b-4d12-916c-75fe2568ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9055a2d0>]}
[0m15:31:12.285811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39248239-6b8b-4d12-916c-75fe2568ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9072c1a0>]}
[0m15:31:12.286490 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m15:31:12.291409 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m15:31:12.305433 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:31:12.305782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:31:12.308807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39248239-6b8b-4d12-916c-75fe2568ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903db1a0>]}
[0m15:31:12.317530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39248239-6b8b-4d12-916c-75fe2568ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902dfd70>]}
[0m15:31:12.317939 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m15:31:12.318477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39248239-6b8b-4d12-916c-75fe2568ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff906230e0>]}
[0m15:31:12.319361 [info ] [MainThread]: 
[0m15:31:12.320029 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:31:12.320838 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:31:12.326720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:12.668831 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:31:12.670558 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:31:12.672366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m15:31:12.676045 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m15:31:12.680477 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:31:12.682058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39248239-6b8b-4d12-916c-75fe2568ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71499730>]}
[0m15:31:12.682723 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:31:12.683466 [info ] [MainThread]: 
[0m15:31:12.689634 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m15:31:12.690150 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m15:31:12.690860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m15:31:12.691217 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m15:31:12.694457 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m15:31:12.695526 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 15:31:12.691466 => 15:31:12.695393
[0m15:31:12.695858 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m15:31:12.727613 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m15:31:12.732907 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:31:12.738359 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m15:31:12.740720 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:31:12.742858 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m15:31:12.744112 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m15:31:12.746382 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:31:12.749175 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m15:31:12.750481 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:31:12.763761 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m15:31:12.765183 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:31:12.766227 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 15:31:12.696111 => 15:31:12.766085
[0m15:31:12.766843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39248239-6b8b-4d12-916c-75fe2568ebe5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70f686b0>]}
[0m15:31:12.767356 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.08s]
[0m15:31:12.768071 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m15:31:12.769398 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:12.769710 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m15:31:12.770033 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m15:31:12.770388 [info ] [MainThread]: 
[0m15:31:12.770838 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m15:31:12.771416 [debug] [MainThread]: Command end result
[0m15:31:12.777715 [info ] [MainThread]: 
[0m15:31:12.778254 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:31:12.778626 [info ] [MainThread]: 
[0m15:31:12.779016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:31:12.779695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6423788, "process_user_time": 2.402676, "process_kernel_time": 0.161456, "process_mem_max_rss": "189480", "process_in_blocks": "312", "process_out_blocks": "1735"}
[0m15:31:12.780117 [debug] [MainThread]: Command `dbt run` succeeded at 15:31:12.780032 after 0.64 seconds
[0m15:31:12.780463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7176f620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff711125a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9072ee10>]}
[0m15:31:12.780808 [debug] [MainThread]: Flushing usage events
[0m16:00:16.543524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff802761b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80377530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8123a360>]}


============================== 16:00:16.548349 | ac83a589-23e2-4330-87af-c9397978e3d1 ==============================
[0m16:00:16.548349 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:00:16.549536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:16.639857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac83a589-23e2-4330-87af-c9397978e3d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80275c70>]}
[0m16:00:16.640505 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:00:16.642006 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:00:16.642807 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.1213045, "process_user_time": 1.451243, "process_kernel_time": 0.146743, "process_mem_max_rss": "103156", "process_in_blocks": "72400", "process_out_blocks": "3"}
[0m16:00:16.643287 [debug] [MainThread]: Command `dbt deps` succeeded at 16:00:16.643178 after 0.12 seconds
[0m16:00:16.643597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808b4c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff807d2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8075f350>]}
[0m16:00:16.643910 [debug] [MainThread]: Flushing usage events
[0m16:00:18.948087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877a8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87cc1700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87bc9bb0>]}


============================== 16:00:18.952991 | 409c4417-3af3-44f1-a401-786e31abc240 ==============================
[0m16:00:18.952991 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:00:18.954567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:00:19.044643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '409c4417-3af3-44f1-a401-786e31abc240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877b3620>]}
[0m16:00:19.072546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '409c4417-3af3-44f1-a401-786e31abc240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8785f3e0>]}
[0m16:00:19.073325 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m16:00:19.079053 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:00:19.103151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:00:19.103565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:00:19.106650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '409c4417-3af3-44f1-a401-786e31abc240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8744ffe0>]}
[0m16:00:19.116072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '409c4417-3af3-44f1-a401-786e31abc240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87472ab0>]}
[0m16:00:19.116471 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m16:00:19.117042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409c4417-3af3-44f1-a401-786e31abc240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87658e30>]}
[0m16:00:19.117992 [info ] [MainThread]: 
[0m16:00:19.118821 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:00:19.119946 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:00:19.127206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:00:19.619417 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:00:19.621745 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:00:19.624106 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m16:00:19.628332 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m16:00:19.633200 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:00:19.635001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '409c4417-3af3-44f1-a401-786e31abc240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff693c2ab0>]}
[0m16:00:19.635692 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:00:19.636972 [info ] [MainThread]: 
[0m16:00:19.644938 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m16:00:19.645607 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m16:00:19.646469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m16:00:19.646866 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m16:00:19.650195 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m16:00:19.651255 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 16:00:19.647155 => 16:00:19.651087
[0m16:00:19.651617 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m16:00:19.680581 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m16:00:19.685120 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:00:19.692272 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m16:00:19.696614 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:00:19.700407 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m16:00:19.703316 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m16:00:19.710528 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:00:19.714729 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m16:00:19.718320 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:00:19.740397 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m16:00:19.742960 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:00:19.744818 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 16:00:19.651868 => 16:00:19.744589
[0m16:00:19.745748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409c4417-3af3-44f1-a401-786e31abc240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff693b90d0>]}
[0m16:00:19.746567 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.10s]
[0m16:00:19.747329 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m16:00:19.749661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:19.750346 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m16:00:19.750937 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m16:00:19.751425 [info ] [MainThread]: 
[0m16:00:19.751807 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.63 seconds (0.63s).
[0m16:00:19.752348 [debug] [MainThread]: Command end result
[0m16:00:19.759963 [info ] [MainThread]: 
[0m16:00:19.760467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:19.760807 [info ] [MainThread]: 
[0m16:00:19.761136 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:00:19.762282 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8340841, "process_user_time": 2.411378, "process_kernel_time": 0.197358, "process_mem_max_rss": "184872", "process_in_blocks": "37416", "process_out_blocks": "1735"}
[0m16:00:19.762880 [debug] [MainThread]: Command `dbt run` succeeded at 16:00:19.762768 after 0.83 seconds
[0m16:00:19.763289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ebeff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b547aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87767290>]}
[0m16:00:19.763667 [debug] [MainThread]: Flushing usage events
[0m17:00:17.172593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933a8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff934544d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93457230>]}


============================== 17:00:17.178677 | 45f5b09f-92d5-447d-8eac-38af48aa800c ==============================
[0m17:00:17.178677 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:00:17.181543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m17:00:17.298649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45f5b09f-92d5-447d-8eac-38af48aa800c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933672c0>]}
[0m17:00:17.299491 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:00:17.301420 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:00:17.302448 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15499337, "process_user_time": 1.478002, "process_kernel_time": 0.23664, "process_mem_max_rss": "103400", "process_in_blocks": "55920", "process_out_blocks": "3"}
[0m17:00:17.302911 [debug] [MainThread]: Command `dbt deps` succeeded at 17:00:17.302807 after 0.16 seconds
[0m17:00:17.303258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937e47a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff937cac30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff933b2ba0>]}
[0m17:00:17.303578 [debug] [MainThread]: Flushing usage events
[0m17:00:19.898641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa71db320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7281520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75d4fe0>]}


============================== 17:00:19.902760 | 23e31e73-0d49-42eb-85a2-48291cd35ec9 ==============================
[0m17:00:19.902760 [info ] [MainThread]: Running with dbt=1.7.19
[0m17:00:19.904556 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'send_anonymous_usage_stats': 'True'}
[0m17:00:19.987425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23e31e73-0d49-42eb-85a2-48291cd35ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7118860>]}
[0m17:00:20.018078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23e31e73-0d49-42eb-85a2-48291cd35ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa75d4bf0>]}
[0m17:00:20.019060 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m17:00:20.024912 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m17:00:20.058752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:00:20.059228 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:00:20.062653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23e31e73-0d49-42eb-85a2-48291cd35ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7147ce0>]}
[0m17:00:20.074504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23e31e73-0d49-42eb-85a2-48291cd35ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6e9ff50>]}
[0m17:00:20.074946 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m17:00:20.075687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e31e73-0d49-42eb-85a2-48291cd35ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76f1670>]}
[0m17:00:20.076631 [info ] [MainThread]: 
[0m17:00:20.077345 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m17:00:20.078366 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m17:00:20.084648 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:00:20.645121 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m17:00:20.647090 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m17:00:20.649295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m17:00:20.653581 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m17:00:20.658780 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m17:00:20.660514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23e31e73-0d49-42eb-85a2-48291cd35ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa70b0320>]}
[0m17:00:20.661202 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:00:20.662590 [info ] [MainThread]: 
[0m17:00:20.669565 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m17:00:20.670062 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m17:00:20.670785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m17:00:20.671142 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m17:00:20.674661 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m17:00:20.675837 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 17:00:20.671375 => 17:00:20.675694
[0m17:00:20.676164 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m17:00:20.705937 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m17:00:20.710936 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m17:00:20.716686 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m17:00:20.719815 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m17:00:20.722943 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m17:00:20.724304 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m17:00:20.742968 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m17:00:20.747385 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m17:00:20.750424 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m17:00:20.772898 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m17:00:20.775074 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m17:00:20.776569 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 17:00:20.676410 => 17:00:20.776379
[0m17:00:20.777425 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23e31e73-0d49-42eb-85a2-48291cd35ec9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cb68cb0>]}
[0m17:00:20.778080 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.11s]
[0m17:00:20.779070 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m17:00:20.781172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:00:20.781643 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m17:00:20.781985 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m17:00:20.782426 [info ] [MainThread]: 
[0m17:00:20.783160 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.71 seconds (0.71s).
[0m17:00:20.783944 [debug] [MainThread]: Command end result
[0m17:00:20.791111 [info ] [MainThread]: 
[0m17:00:20.791848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:00:20.792335 [info ] [MainThread]: 
[0m17:00:20.792775 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:00:20.793655 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9153568, "process_user_time": 2.569845, "process_kernel_time": 0.23353, "process_mem_max_rss": "184712", "process_in_blocks": "30288", "process_out_blocks": "1735"}
[0m17:00:20.794142 [debug] [MainThread]: Command `dbt run` succeeded at 17:00:20.794053 after 0.92 seconds
[0m17:00:20.794540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76c2f00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa76533b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88cddc10>]}
[0m17:00:20.794872 [debug] [MainThread]: Flushing usage events
[0m18:05:19.733032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1aaff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1a9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d1aa780>]}


============================== 18:05:19.737018 | e42f57c3-82b3-4f72-90b8-fdb6a0cdf864 ==============================
[0m18:05:19.737018 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:05:19.737583 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:19.792082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e42f57c3-82b3-4f72-90b8-fdb6a0cdf864', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8bdaf0>]}
[0m18:05:19.792892 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:05:19.794728 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m18:05:19.795659 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.084053, "process_user_time": 1.400319, "process_kernel_time": 0.182171, "process_mem_max_rss": "103704", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m18:05:19.796051 [debug] [MainThread]: Command `dbt deps` succeeded at 18:05:19.795967 after 0.08 seconds
[0m18:05:19.796347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d5cad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81f673b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd7db20>]}
[0m18:05:19.796618 [debug] [MainThread]: Flushing usage events
[0m18:05:21.911930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94048230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f3ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94048140>]}


============================== 18:05:21.915553 | ef60205f-c846-4720-8f4b-c0c5f2f1e03a ==============================
[0m18:05:21.915553 [info ] [MainThread]: Running with dbt=1.7.19
[0m18:05:21.916124 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:05:21.988716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef60205f-c846-4720-8f4b-c0c5f2f1e03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff940f4470>]}
[0m18:05:22.017086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef60205f-c846-4720-8f4b-c0c5f2f1e03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fb1670>]}
[0m18:05:22.017682 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m18:05:22.022197 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m18:05:22.035950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:05:22.036269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:05:22.038988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef60205f-c846-4720-8f4b-c0c5f2f1e03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93e54260>]}
[0m18:05:22.047893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef60205f-c846-4720-8f4b-c0c5f2f1e03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d4c3e0>]}
[0m18:05:22.048283 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m18:05:22.048586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef60205f-c846-4720-8f4b-c0c5f2f1e03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff943a7560>]}
[0m18:05:22.049484 [info ] [MainThread]: 
[0m18:05:22.050128 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m18:05:22.050844 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m18:05:22.056370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:05:22.370745 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m18:05:22.372570 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:05:22.374550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m18:05:22.378220 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m18:05:22.381717 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:05:22.383303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef60205f-c846-4720-8f4b-c0c5f2f1e03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93f89610>]}
[0m18:05:22.383858 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:05:22.384913 [info ] [MainThread]: 
[0m18:05:22.390800 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m18:05:22.391258 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m18:05:22.391899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m18:05:22.392267 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m18:05:22.395526 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m18:05:22.396787 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 18:05:22.392540 => 18:05:22.396655
[0m18:05:22.397138 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m18:05:22.433207 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m18:05:22.439575 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:22.445183 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m18:05:22.447804 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:05:22.449949 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m18:05:22.450842 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m18:05:22.456574 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m18:05:22.459427 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m18:05:22.460751 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:05:22.474308 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m18:05:22.475656 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m18:05:22.476680 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 18:05:22.397348 => 18:05:22.476541
[0m18:05:22.477233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef60205f-c846-4720-8f4b-c0c5f2f1e03a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b589670>]}
[0m18:05:22.477693 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.09s]
[0m18:05:22.478417 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m18:05:22.479956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:05:22.480295 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m18:05:22.480588 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m18:05:22.480909 [info ] [MainThread]: 
[0m18:05:22.481252 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m18:05:22.481874 [debug] [MainThread]: Command end result
[0m18:05:22.487769 [info ] [MainThread]: 
[0m18:05:22.488282 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:05:22.488694 [info ] [MainThread]: 
[0m18:05:22.489100 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:05:22.489920 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.59769344, "process_user_time": 2.321282, "process_kernel_time": 0.12344, "process_mem_max_rss": "187236", "process_in_blocks": "200", "process_out_blocks": "1735"}
[0m18:05:22.490345 [debug] [MainThread]: Command `dbt run` succeeded at 18:05:22.490263 after 0.60 seconds
[0m18:05:22.490624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff944fbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff913d6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9455f0e0>]}
[0m18:05:22.490884 [debug] [MainThread]: Flushing usage events
[0m19:14:05.983759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a09e240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeb2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a147530>]}


============================== 19:14:05.987921 | d05d9fc7-ac69-40d1-8a11-e59b0d4aaa22 ==============================
[0m19:14:05.987921 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:14:05.989427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:14:06.040231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd05d9fc7-ac69-40d1-8a11-e59b0d4aaa22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5b56d0>]}
[0m19:14:06.041000 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:14:06.042575 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:14:06.044465 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08270075, "process_user_time": 1.41505, "process_kernel_time": 0.151219, "process_mem_max_rss": "103516", "process_in_blocks": "17616", "process_out_blocks": "3"}
[0m19:14:06.044889 [debug] [MainThread]: Command `dbt deps` succeeded at 19:14:06.044799 after 0.08 seconds
[0m19:14:06.045217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aeb2360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a19f5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a403800>]}
[0m19:14:06.045543 [debug] [MainThread]: Flushing usage events
[0m19:14:08.218669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1649160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b1c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1cf5d00>]}


============================== 19:14:08.222509 | 57490ee1-2b1c-4f39-99d2-85bc4c4b11c1 ==============================
[0m19:14:08.222509 [info ] [MainThread]: Running with dbt=1.7.19
[0m19:14:08.223418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:14:08.297536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57490ee1-2b1c-4f39-99d2-85bc4c4b11c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa158a2d0>]}
[0m19:14:08.324151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57490ee1-2b1c-4f39-99d2-85bc4c4b11c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1b61b20>]}
[0m19:14:08.324750 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m19:14:08.329646 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m19:14:08.345097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:08.345467 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:08.348321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '57490ee1-2b1c-4f39-99d2-85bc4c4b11c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15207a0>]}
[0m19:14:08.357147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '57490ee1-2b1c-4f39-99d2-85bc4c4b11c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa130c200>]}
[0m19:14:08.357568 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m19:14:08.358107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57490ee1-2b1c-4f39-99d2-85bc4c4b11c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa15b0d70>]}
[0m19:14:08.359071 [info ] [MainThread]: 
[0m19:14:08.359778 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m19:14:08.360657 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m19:14:08.366963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:08.707725 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m19:14:08.709745 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m19:14:08.713198 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m19:14:08.720167 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m19:14:08.725627 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m19:14:08.727497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '57490ee1-2b1c-4f39-99d2-85bc4c4b11c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa144a900>]}
[0m19:14:08.728181 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:08.729474 [info ] [MainThread]: 
[0m19:14:08.736031 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m19:14:08.736536 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m19:14:08.737223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m19:14:08.737565 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m19:14:08.741026 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m19:14:08.742104 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 19:14:08.737806 => 19:14:08.741962
[0m19:14:08.742428 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m19:14:08.771570 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m19:14:08.776474 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m19:14:08.781718 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m19:14:08.784987 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m19:14:08.787392 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m19:14:08.788592 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m19:14:08.800131 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m19:14:08.803327 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m19:14:08.804869 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m19:14:08.818160 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m19:14:08.819350 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m19:14:08.820337 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 19:14:08.742721 => 19:14:08.820215
[0m19:14:08.820925 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '57490ee1-2b1c-4f39-99d2-85bc4c4b11c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa01f1c10>]}
[0m19:14:08.821395 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.08s]
[0m19:14:08.822059 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m19:14:08.823359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:08.823738 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m19:14:08.824055 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m19:14:08.824429 [info ] [MainThread]: 
[0m19:14:08.824949 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m19:14:08.825553 [debug] [MainThread]: Command end result
[0m19:14:08.831662 [info ] [MainThread]: 
[0m19:14:08.832178 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:08.832563 [info ] [MainThread]: 
[0m19:14:08.832932 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:14:08.833700 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.63483065, "process_user_time": 2.320292, "process_kernel_time": 0.147954, "process_mem_max_rss": "184968", "process_in_blocks": "1184", "process_out_blocks": "1735"}
[0m19:14:08.834130 [debug] [MainThread]: Command `dbt run` succeeded at 19:14:08.834023 after 0.64 seconds
[0m19:14:08.834539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1c88dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa19aeea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff827bffb0>]}
[0m19:14:08.834874 [debug] [MainThread]: Flushing usage events
[0m20:00:15.928857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ca38500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf52cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cf51850>]}


============================== 20:00:15.933929 | 682c9a65-7342-4bf8-9f2f-a598c852b76f ==============================
[0m20:00:15.933929 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:00:15.936832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:00:16.037479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '682c9a65-7342-4bf8-9f2f-a598c852b76f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9f71d0>]}
[0m20:00:16.038368 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:00:16.040287 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m20:00:16.041312 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13583958, "process_user_time": 1.508472, "process_kernel_time": 0.230613, "process_mem_max_rss": "102932", "process_in_blocks": "96056", "process_out_blocks": "3"}
[0m20:00:16.041815 [debug] [MainThread]: Command `dbt deps` succeeded at 20:00:16.041714 after 0.14 seconds
[0m20:00:16.042205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dd4ce90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee8df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9f71d0>]}
[0m20:00:16.042533 [debug] [MainThread]: Flushing usage events
[0m20:00:18.331980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90d1a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91bca300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9305a180>]}


============================== 20:00:18.335851 | 3cd207fc-8b1d-4ace-8ffd-6fd772224a72 ==============================
[0m20:00:18.335851 [info ] [MainThread]: Running with dbt=1.7.19
[0m20:00:18.336958 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'send_anonymous_usage_stats': 'True'}
[0m20:00:18.419467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3cd207fc-8b1d-4ace-8ffd-6fd772224a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914282c0>]}
[0m20:00:18.446444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3cd207fc-8b1d-4ace-8ffd-6fd772224a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90c89af0>]}
[0m20:00:18.447129 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m20:00:18.453139 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m20:00:18.476479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:00:18.476884 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:00:18.480086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3cd207fc-8b1d-4ace-8ffd-6fd772224a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909c7170>]}
[0m20:00:18.489835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3cd207fc-8b1d-4ace-8ffd-6fd772224a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908cbfe0>]}
[0m20:00:18.490235 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m20:00:18.490852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd207fc-8b1d-4ace-8ffd-6fd772224a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908cae10>]}
[0m20:00:18.491875 [info ] [MainThread]: 
[0m20:00:18.492537 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m20:00:18.493414 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m20:00:18.499609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:00:19.077516 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m20:00:19.079693 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m20:00:19.081941 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m20:00:19.086254 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m20:00:19.100470 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:00:19.102131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3cd207fc-8b1d-4ace-8ffd-6fd772224a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7284c9b0>]}
[0m20:00:19.102755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:00:19.103474 [info ] [MainThread]: 
[0m20:00:19.110624 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m20:00:19.111114 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m20:00:19.111848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m20:00:19.112187 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m20:00:19.115468 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m20:00:19.116714 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 20:00:19.112419 => 20:00:19.116556
[0m20:00:19.117034 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m20:00:19.145707 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m20:00:19.152383 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:00:19.157758 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m20:00:19.167907 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m20:00:19.172059 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m20:00:19.173766 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m20:00:19.189487 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m20:00:19.192693 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m20:00:19.195490 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m20:00:19.208908 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m20:00:19.210281 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m20:00:19.211310 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 20:00:19.117255 => 20:00:19.211174
[0m20:00:19.211904 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3cd207fc-8b1d-4ace-8ffd-6fd772224a72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907daed0>]}
[0m20:00:19.212372 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.10s]
[0m20:00:19.213613 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m20:00:19.215072 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:00:19.215403 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m20:00:19.215856 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m20:00:19.216270 [info ] [MainThread]: 
[0m20:00:19.216736 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m20:00:19.217343 [debug] [MainThread]: Command end result
[0m20:00:19.223428 [info ] [MainThread]: 
[0m20:00:19.223983 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:00:19.224402 [info ] [MainThread]: 
[0m20:00:19.224891 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m20:00:19.225759 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9139973, "process_user_time": 2.388397, "process_kernel_time": 0.185887, "process_mem_max_rss": "184064", "process_in_blocks": "92808", "process_out_blocks": "1735"}
[0m20:00:19.226200 [debug] [MainThread]: Command `dbt run` succeeded at 20:00:19.226108 after 0.91 seconds
[0m20:00:19.226549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95805eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909a18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71a48d70>]}
[0m20:00:19.226971 [debug] [MainThread]: Flushing usage events
[0m21:01:40.739764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff879da6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dfba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff888ad160>]}


============================== 21:01:40.751048 | 7f9ad076-b5f6-49ca-ada6-80cad1c748a2 ==============================
[0m21:01:40.751048 [info ] [MainThread]: Running with dbt=1.7.19
[0m21:01:40.755838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:01:40.879098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f9ad076-b5f6-49ca-ada6-80cad1c748a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87a5b740>]}
[0m21:01:40.880090 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:01:40.881968 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m21:01:40.883203 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20123766, "process_user_time": 1.656521, "process_kernel_time": 0.289538, "process_mem_max_rss": "103260", "process_in_blocks": "93032", "process_out_blocks": "3"}
[0m21:01:40.883678 [debug] [MainThread]: Command `dbt deps` succeeded at 21:01:40.883559 after 0.20 seconds
[0m21:01:40.884063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87aec5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88018d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87886d50>]}
[0m21:01:40.884406 [debug] [MainThread]: Flushing usage events
[0m21:01:44.113011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9addd700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9addd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9addc8f0>]}


============================== 21:01:44.118189 | b70f34f8-78ea-461b-924b-2571b2d5029c ==============================
[0m21:01:44.118189 [info ] [MainThread]: Running with dbt=1.7.19
[0m21:01:44.123047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:01:44.225412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b70f34f8-78ea-461b-924b-2571b2d5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad99af0>]}
[0m21:01:44.255003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b70f34f8-78ea-461b-924b-2571b2d5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad47e00>]}
[0m21:01:44.256065 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m21:01:44.262178 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m21:01:44.289117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:01:44.289567 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:01:44.292995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70f34f8-78ea-461b-924b-2571b2d5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad1e300>]}
[0m21:01:44.308350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70f34f8-78ea-461b-924b-2571b2d5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aaa77d0>]}
[0m21:01:44.309548 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m21:01:44.310723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70f34f8-78ea-461b-924b-2571b2d5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ad45730>]}
[0m21:01:44.312551 [info ] [MainThread]: 
[0m21:01:44.314727 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m21:01:44.319218 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m21:01:44.327851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:01:45.059081 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m21:01:45.062845 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m21:01:45.067184 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m21:01:45.074080 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m21:01:45.090084 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m21:01:45.092828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70f34f8-78ea-461b-924b-2571b2d5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cdd9520>]}
[0m21:01:45.094165 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:01:45.095852 [info ] [MainThread]: 
[0m21:01:45.105823 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m21:01:45.106549 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m21:01:45.107499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m21:01:45.107866 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m21:01:45.112215 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m21:01:45.113692 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 21:01:45.108128 => 21:01:45.113501
[0m21:01:45.114053 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m21:01:45.148693 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m21:01:45.166012 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m21:01:45.174539 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m21:01:45.179595 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m21:01:45.182312 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m21:01:45.183545 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m21:01:45.197038 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m21:01:45.200297 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m21:01:45.203314 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m21:01:45.225653 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m21:01:45.227720 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m21:01:45.229163 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 21:01:45.114489 => 21:01:45.228951
[0m21:01:45.230207 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70f34f8-78ea-461b-924b-2571b2d5029c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7cbd0bf0>]}
[0m21:01:45.230876 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.12s]
[0m21:01:45.233345 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m21:01:45.235707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:01:45.236143 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m21:01:45.236515 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m21:01:45.236983 [info ] [MainThread]: 
[0m21:01:45.237710 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m21:01:45.238521 [debug] [MainThread]: Command end result
[0m21:01:45.248737 [info ] [MainThread]: 
[0m21:01:45.249446 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:01:45.249876 [info ] [MainThread]: 
[0m21:01:45.250345 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:01:45.252117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1629201, "process_user_time": 3.095756, "process_kernel_time": 0.452987, "process_mem_max_rss": "184324", "process_in_blocks": "92808", "process_out_blocks": "1735"}
[0m21:01:45.252872 [debug] [MainThread]: Command `dbt run` succeeded at 21:01:45.252763 after 1.16 seconds
[0m21:01:45.253437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7c3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1c25a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c9b5490>]}
[0m21:01:45.253810 [debug] [MainThread]: Flushing usage events
[0m22:00:24.861083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb095cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1e8a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb095d700>]}


============================== 22:00:24.866324 | 0cc16ffb-e5af-48d7-b2e1-47933b5d7fb3 ==============================
[0m22:00:24.866324 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:00:24.868620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m22:00:24.960011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cc16ffb-e5af-48d7-b2e1-47933b5d7fb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb095c2f0>]}
[0m22:00:24.960713 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:00:24.962255 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m22:00:24.963398 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12587708, "process_user_time": 1.56997, "process_kernel_time": 0.264489, "process_mem_max_rss": "103448", "process_in_blocks": "97784", "process_out_blocks": "3"}
[0m22:00:24.963954 [debug] [MainThread]: Command `dbt deps` succeeded at 22:00:24.963850 after 0.13 seconds
[0m22:00:24.964329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0d98980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0e0ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1897ec0>]}
[0m22:00:24.964697 [debug] [MainThread]: Flushing usage events
[0m22:00:27.449608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf95cb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1db24e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafcc2f00>]}


============================== 22:00:27.453422 | 1b4b758d-9704-482e-b98c-34fec4573a42 ==============================
[0m22:00:27.453422 [info ] [MainThread]: Running with dbt=1.7.19
[0m22:00:27.454705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:00:27.546654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b4b758d-9704-482e-b98c-34fec4573a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf89db50>]}
[0m22:00:27.576818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b4b758d-9704-482e-b98c-34fec4573a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffafd7ee70>]}
[0m22:00:27.577867 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m22:00:27.584029 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m22:00:27.609931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:00:27.612188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:00:27.615991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b4b758d-9704-482e-b98c-34fec4573a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8c6b10>]}
[0m22:00:27.640450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b4b758d-9704-482e-b98c-34fec4573a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf6201a0>]}
[0m22:00:27.641695 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m22:00:27.642482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4b758d-9704-482e-b98c-34fec4573a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0746270>]}
[0m22:00:27.644263 [info ] [MainThread]: 
[0m22:00:27.645511 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m22:00:27.646709 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m22:00:27.655238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:28.685286 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m22:00:28.691714 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m22:00:28.698017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m22:00:28.705330 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m22:00:28.724996 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m22:00:28.726987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b4b758d-9704-482e-b98c-34fec4573a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff903e9280>]}
[0m22:00:28.728019 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:00:28.732310 [info ] [MainThread]: 
[0m22:00:28.740839 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m22:00:28.741500 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m22:00:28.742542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m22:00:28.742999 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m22:00:28.747152 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m22:00:28.748782 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 22:00:28.743401 => 22:00:28.748616
[0m22:00:28.749152 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m22:00:28.789795 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m22:00:28.814831 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m22:00:28.823740 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m22:00:28.830107 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m22:00:28.832934 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m22:00:28.834515 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m22:00:28.863640 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m22:00:28.867501 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m22:00:28.870754 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m22:00:28.892505 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m22:00:28.895838 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m22:00:28.897494 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 22:00:28.749385 => 22:00:28.897323
[0m22:00:28.898537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b4b758d-9704-482e-b98c-34fec4573a42', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf556e10>]}
[0m22:00:28.899229 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.16s]
[0m22:00:28.900300 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m22:00:28.902713 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:28.903185 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m22:00:28.903556 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m22:00:28.903988 [info ] [MainThread]: 
[0m22:00:28.904610 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.26 seconds (1.26s).
[0m22:00:28.906692 [debug] [MainThread]: Command end result
[0m22:00:28.922731 [info ] [MainThread]: 
[0m22:00:28.926188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:00:28.927674 [info ] [MainThread]: 
[0m22:00:28.928668 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:00:28.931625 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5029254, "process_user_time": 2.725272, "process_kernel_time": 0.359521, "process_mem_max_rss": "185916", "process_in_blocks": "93048", "process_out_blocks": "1735"}
[0m22:00:28.932351 [debug] [MainThread]: Command `dbt run` succeeded at 22:00:28.932246 after 1.50 seconds
[0m22:00:28.932805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf919a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff914c2d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb00474a0>]}
[0m22:00:28.933248 [debug] [MainThread]: Flushing usage events
[0m23:00:56.474069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a04e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a05100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a053d0>]}


============================== 23:00:56.479169 | 2d9615b0-408e-42a3-94a5-0155a9e7d47e ==============================
[0m23:00:56.479169 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:00:56.480955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:00:56.569594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d9615b0-408e-42a3-94a5-0155a9e7d47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968b3650>]}
[0m23:00:56.570277 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:00:56.571735 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:00:56.572552 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12117175, "process_user_time": 1.433533, "process_kernel_time": 0.239255, "process_mem_max_rss": "103260", "process_in_blocks": "95880", "process_out_blocks": "3"}
[0m23:00:56.572964 [debug] [MainThread]: Command `dbt deps` succeeded at 23:00:56.572877 after 0.12 seconds
[0m23:00:56.573287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96f1dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968b32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968b3650>]}
[0m23:00:56.573627 [debug] [MainThread]: Flushing usage events
[0m23:00:58.891817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881d8f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff888efd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff885d5160>]}


============================== 23:00:58.898496 | 9b6e1288-f526-40cd-848b-426988aaf44a ==============================
[0m23:00:58.898496 [info ] [MainThread]: Running with dbt=1.7.19
[0m23:00:58.900844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:00:58.981862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b6e1288-f526-40cd-848b-426988aaf44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff882db560>]}
[0m23:00:59.009752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b6e1288-f526-40cd-848b-426988aaf44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881e2d80>]}
[0m23:00:59.010508 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m23:00:59.016497 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m23:00:59.040851 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:00:59.041235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:00:59.044105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b6e1288-f526-40cd-848b-426988aaf44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff881e3260>]}
[0m23:00:59.053389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b6e1288-f526-40cd-848b-426988aaf44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ed9010>]}
[0m23:00:59.053756 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m23:00:59.054291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b6e1288-f526-40cd-848b-426988aaf44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8825fd40>]}
[0m23:00:59.055180 [info ] [MainThread]: 
[0m23:00:59.055866 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m23:00:59.056818 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m23:00:59.063328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:00:59.751501 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m23:00:59.753955 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m23:00:59.756392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m23:00:59.760902 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m23:00:59.779845 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m23:00:59.782298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b6e1288-f526-40cd-848b-426988aaf44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff78b5b6b0>]}
[0m23:00:59.783119 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:00:59.784534 [info ] [MainThread]: 
[0m23:00:59.793897 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m23:00:59.794541 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m23:00:59.795434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m23:00:59.795809 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m23:00:59.799466 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m23:00:59.800689 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 23:00:59.796053 => 23:00:59.800509
[0m23:00:59.801044 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m23:00:59.831446 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m23:00:59.838803 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m23:00:59.844056 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m23:00:59.848087 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m23:00:59.850239 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m23:00:59.851327 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m23:00:59.866741 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m23:00:59.871755 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m23:00:59.878109 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m23:00:59.899467 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m23:00:59.902025 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m23:00:59.903523 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 23:00:59.801290 => 23:00:59.903336
[0m23:00:59.904371 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b6e1288-f526-40cd-848b-426988aaf44a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87dacbc0>]}
[0m23:00:59.905071 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.11s]
[0m23:00:59.905926 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m23:00:59.907720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:00:59.908053 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m23:00:59.908381 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m23:00:59.908784 [info ] [MainThread]: 
[0m23:00:59.909344 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m23:00:59.910035 [debug] [MainThread]: Command end result
[0m23:00:59.918104 [info ] [MainThread]: 
[0m23:00:59.918610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:00:59.919042 [info ] [MainThread]: 
[0m23:00:59.919473 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:00:59.920478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0573422, "process_user_time": 2.405683, "process_kernel_time": 0.246736, "process_mem_max_rss": "186420", "process_in_blocks": "93184", "process_out_blocks": "1735"}
[0m23:00:59.920953 [debug] [MainThread]: Command `dbt run` succeeded at 23:00:59.920858 after 1.06 seconds
[0m23:00:59.921320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88287440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9a81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff68ccbf80>]}
[0m23:00:59.921674 [debug] [MainThread]: Flushing usage events
[0m00:08:12.028374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90909010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ddc530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90ff3530>]}


============================== 00:08:12.033578 | 4d6375e3-6ee1-4242-8580-46aa31431039 ==============================
[0m00:08:12.033578 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:08:12.034616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m00:08:12.131797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d6375e3-6ee1-4242-8580-46aa31431039', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908c62a0>]}
[0m00:08:12.132537 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:08:12.134206 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m00:08:12.135153 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.12993588, "process_user_time": 1.421906, "process_kernel_time": 0.260153, "process_mem_max_rss": "102884", "process_in_blocks": "96384", "process_out_blocks": "3"}
[0m00:08:12.135591 [debug] [MainThread]: Command `dbt deps` succeeded at 00:08:12.135489 after 0.13 seconds
[0m00:08:12.135959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff907b6c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90792f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff909b4680>]}
[0m00:08:12.136329 [debug] [MainThread]: Flushing usage events
[0m00:08:14.462808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb91086e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbbb77a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9744b30>]}


============================== 00:08:14.467115 | 2cca33be-a633-4425-af83-87f7f56fb6d1 ==============================
[0m00:08:14.467115 [info ] [MainThread]: Running with dbt=1.7.19
[0m00:08:14.470488 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:08:14.565193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cca33be-a633-4425-af83-87f7f56fb6d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba23ffb0>]}
[0m00:08:14.597037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cca33be-a633-4425-af83-87f7f56fb6d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9500c20>]}
[0m00:08:14.597832 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m00:08:14.603445 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m00:08:14.626374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:08:14.626739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:08:14.629835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cca33be-a633-4425-af83-87f7f56fb6d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8f01880>]}
[0m00:08:14.639466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cca33be-a633-4425-af83-87f7f56fb6d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8dcecf0>]}
[0m00:08:14.639825 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m00:08:14.640450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cca33be-a633-4425-af83-87f7f56fb6d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb90c5d00>]}
[0m00:08:14.641436 [info ] [MainThread]: 
[0m00:08:14.642146 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m00:08:14.643069 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m00:08:14.648949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:08:15.317287 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m00:08:15.319562 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m00:08:15.322406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m00:08:15.326928 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m00:08:15.341681 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:08:15.343487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cca33be-a633-4425-af83-87f7f56fb6d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8159ca0>]}
[0m00:08:15.344234 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:08:15.345364 [info ] [MainThread]: 
[0m00:08:15.352911 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m00:08:15.353401 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m00:08:15.354078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m00:08:15.354402 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m00:08:15.357996 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m00:08:15.359659 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 00:08:15.354632 => 00:08:15.359510
[0m00:08:15.360049 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m00:08:15.401787 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m00:08:15.409220 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m00:08:15.414730 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m00:08:15.419005 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m00:08:15.421339 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m00:08:15.423275 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m00:08:15.439670 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m00:08:15.442848 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m00:08:15.444658 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m00:08:15.458335 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m00:08:15.459589 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m00:08:15.461063 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 00:08:15.360301 => 00:08:15.460794
[0m00:08:15.462210 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2cca33be-a633-4425-af83-87f7f56fb6d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab9d0c20>]}
[0m00:08:15.462945 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.11s]
[0m00:08:15.464563 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m00:08:15.466194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:08:15.466536 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m00:08:15.466847 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m00:08:15.467263 [info ] [MainThread]: 
[0m00:08:15.467765 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m00:08:15.469761 [debug] [MainThread]: Command end result
[0m00:08:15.485417 [info ] [MainThread]: 
[0m00:08:15.486482 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:08:15.486989 [info ] [MainThread]: 
[0m00:08:15.487556 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:08:15.489145 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.046929, "process_user_time": 2.430921, "process_kernel_time": 0.282782, "process_mem_max_rss": "185984", "process_in_blocks": "93376", "process_out_blocks": "1735"}
[0m00:08:15.489820 [debug] [MainThread]: Command `dbt run` succeeded at 00:08:15.489679 after 1.05 seconds
[0m00:08:15.490453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96627e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99aa2e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99ed7200>]}
[0m00:08:15.490984 [debug] [MainThread]: Flushing usage events
[0m01:16:16.376913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989a83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98a57530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989a8ec0>]}


============================== 01:16:16.381867 | 635a1873-9055-444b-88c2-33f8e944e3a0 ==============================
[0m01:16:16.381867 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:16:16.383833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:16:16.469610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635a1873-9055-444b-88c2-33f8e944e3a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989b2f90>]}
[0m01:16:16.470250 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:16:16.471879 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m01:16:16.472711 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11845063, "process_user_time": 1.415444, "process_kernel_time": 0.279855, "process_mem_max_rss": "103304", "process_in_blocks": "61736", "process_out_blocks": "3"}
[0m01:16:16.473126 [debug] [MainThread]: Command `dbt deps` succeeded at 01:16:16.473034 after 0.12 seconds
[0m01:16:16.473448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98ec19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9882d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff989ab5f0>]}
[0m01:16:16.473771 [debug] [MainThread]: Flushing usage events
[0m01:16:18.922454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaebe2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf21cdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf8b5820>]}


============================== 01:16:18.927317 | 2d240168-0983-435e-ab67-178e77921be3 ==============================
[0m01:16:18.927317 [info ] [MainThread]: Running with dbt=1.7.19
[0m01:16:18.928081 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:16:19.008151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d240168-0983-435e-ab67-178e77921be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae97a2d0>]}
[0m01:16:19.034582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d240168-0983-435e-ab67-178e77921be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf21cdd0>]}
[0m01:16:19.035296 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m01:16:19.040854 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m01:16:19.067419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:16:19.067952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:16:19.072155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d240168-0983-435e-ab67-178e77921be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb9f620>]}
[0m01:16:19.082932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d240168-0983-435e-ab67-178e77921be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae8a7c80>]}
[0m01:16:19.083391 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m01:16:19.084075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d240168-0983-435e-ab67-178e77921be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec8b5c0>]}
[0m01:16:19.085163 [info ] [MainThread]: 
[0m01:16:19.085875 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m01:16:19.086935 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m01:16:19.094339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:16:19.469975 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m01:16:19.472371 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m01:16:19.474841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m01:16:19.479208 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m01:16:19.493182 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m01:16:19.495040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d240168-0983-435e-ab67-178e77921be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bf350a0>]}
[0m01:16:19.495728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:16:19.497316 [info ] [MainThread]: 
[0m01:16:19.504773 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m01:16:19.505274 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m01:16:19.505988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m01:16:19.506329 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m01:16:19.509692 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m01:16:19.511332 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 01:16:19.506585 => 01:16:19.511179
[0m01:16:19.511664 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m01:16:19.551091 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m01:16:19.558442 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m01:16:19.564520 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m01:16:19.568869 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m01:16:19.571242 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m01:16:19.572593 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m01:16:19.580649 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m01:16:19.584211 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m01:16:19.585648 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m01:16:19.599456 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m01:16:19.600601 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m01:16:19.601688 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 01:16:19.511910 => 01:16:19.601554
[0m01:16:19.602435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d240168-0983-435e-ab67-178e77921be3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b5989b0>]}
[0m01:16:19.602962 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.10s]
[0m01:16:19.603651 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m01:16:19.605235 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:16:19.605587 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m01:16:19.605860 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m01:16:19.606213 [info ] [MainThread]: 
[0m01:16:19.606658 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m01:16:19.607318 [debug] [MainThread]: Command end result
[0m01:16:19.615005 [info ] [MainThread]: 
[0m01:16:19.615595 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:16:19.616058 [info ] [MainThread]: 
[0m01:16:19.616523 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m01:16:19.617516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.71982473, "process_user_time": 2.386194, "process_kernel_time": 0.197505, "process_mem_max_rss": "184828", "process_in_blocks": "1800", "process_out_blocks": "1735"}
[0m01:16:19.618051 [debug] [MainThread]: Command `dbt run` succeeded at 01:16:19.617944 after 0.72 seconds
[0m01:16:19.618425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaeb9ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec8b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b24950>]}
[0m01:16:19.618766 [debug] [MainThread]: Flushing usage events
[0m02:07:05.143296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae939010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae9e7590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae93a1e0>]}


============================== 02:07:05.147789 | 17fba60a-2105-41b1-873b-20d342859eec ==============================
[0m02:07:05.147789 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:07:05.149990 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:07:05.213161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17fba60a-2105-41b1-873b-20d342859eec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7e63f0>]}
[0m02:07:05.214231 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:07:05.216961 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m02:07:05.218299 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09800017, "process_user_time": 1.474056, "process_kernel_time": 0.24984, "process_mem_max_rss": "103772", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m02:07:05.218837 [debug] [MainThread]: Command `dbt deps` succeeded at 02:07:05.218727 after 0.10 seconds
[0m02:07:05.219224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaed76c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae7e63f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaec9f080>]}
[0m02:07:05.219611 [debug] [MainThread]: Flushing usage events
[0m02:07:07.767957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8acaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7dee8da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7e1796a0>]}


============================== 02:07:07.772280 | 68d14f0a-bfda-4c60-bcca-26cde4621342 ==============================
[0m02:07:07.772280 [info ] [MainThread]: Running with dbt=1.7.19
[0m02:07:07.774432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'send_anonymous_usage_stats': 'True'}
[0m02:07:07.854746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68d14f0a-bfda-4c60-bcca-26cde4621342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d8ae900>]}
[0m02:07:07.881597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68d14f0a-bfda-4c60-bcca-26cde4621342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddc31a0>]}
[0m02:07:07.882269 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m02:07:07.887374 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m02:07:07.905119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m02:07:07.905479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m02:07:07.908441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68d14f0a-bfda-4c60-bcca-26cde4621342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d6a9910>]}
[0m02:07:07.918208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68d14f0a-bfda-4c60-bcca-26cde4621342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d56fe60>]}
[0m02:07:07.918612 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m02:07:07.919236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d14f0a-bfda-4c60-bcca-26cde4621342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7d928da0>]}
[0m02:07:07.920172 [info ] [MainThread]: 
[0m02:07:07.920924 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m02:07:07.921878 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m02:07:07.929081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:07:08.336468 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m02:07:08.339714 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m02:07:08.343218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m02:07:08.348078 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m02:07:08.355418 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m02:07:08.357554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d14f0a-bfda-4c60-bcca-26cde4621342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f069520>]}
[0m02:07:08.358474 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:07:08.360209 [info ] [MainThread]: 
[0m02:07:08.370530 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m02:07:08.372666 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m02:07:08.373549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m02:07:08.374115 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m02:07:08.379354 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m02:07:08.381759 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 02:07:08.374513 => 02:07:08.381567
[0m02:07:08.382201 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m02:07:08.431088 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m02:07:08.436702 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m02:07:08.442281 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m02:07:08.444882 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m02:07:08.447143 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m02:07:08.448108 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m02:07:08.454527 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m02:07:08.457546 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m02:07:08.458906 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m02:07:08.472650 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m02:07:08.473923 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m02:07:08.475120 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 02:07:08.382528 => 02:07:08.474936
[0m02:07:08.475799 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68d14f0a-bfda-4c60-bcca-26cde4621342', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5e967590>]}
[0m02:07:08.476364 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.10s]
[0m02:07:08.477110 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m02:07:08.479634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:07:08.480203 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m02:07:08.480544 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m02:07:08.480951 [info ] [MainThread]: 
[0m02:07:08.481896 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m02:07:08.482770 [debug] [MainThread]: Command end result
[0m02:07:08.493192 [info ] [MainThread]: 
[0m02:07:08.494092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:07:08.494546 [info ] [MainThread]: 
[0m02:07:08.495016 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m02:07:08.496559 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7511318, "process_user_time": 2.536773, "process_kernel_time": 0.306354, "process_mem_max_rss": "187408", "process_out_blocks": "1735", "process_in_blocks": "0"}
[0m02:07:08.497158 [debug] [MainThread]: Command `dbt run` succeeded at 02:07:08.497019 after 0.75 seconds
[0m02:07:08.497585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ddc1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81667980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5f3ba0c0>]}
[0m02:07:08.497990 [debug] [MainThread]: Flushing usage events
[0m03:01:00.957151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f09b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f197560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f197fb0>]}


============================== 03:01:00.970007 | 9c2a6965-fbf0-4612-852b-fafb86e32b96 ==============================
[0m03:01:00.970007 [info ] [MainThread]: Running with dbt=1.7.19
[0m03:01:00.973623 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:01:01.026314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c2a6965-fbf0-4612-852b-fafb86e32b96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f4b6e40>]}
[0m03:01:01.027186 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:01:01.029619 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m03:01:01.030474 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.09568754, "process_user_time": 1.418849, "process_kernel_time": 0.227136, "process_mem_max_rss": "103776", "process_in_blocks": "56", "process_out_blocks": "3"}
[0m03:01:01.031009 [debug] [MainThread]: Command `dbt deps` succeeded at 03:01:01.030901 after 0.10 seconds
[0m03:01:01.031339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa14ea4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f5f8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f57e720>]}
[0m03:01:01.031671 [debug] [MainThread]: Flushing usage events
[0m03:01:03.435042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90248c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90a3de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90248710>]}


============================== 03:01:03.439127 | e3bf96d2-efd9-435c-a87d-fd60284090a4 ==============================
[0m03:01:03.439127 [info ] [MainThread]: Running with dbt=1.7.19
[0m03:01:03.441281 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m03:01:03.525428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3bf96d2-efd9-435c-a87d-fd60284090a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90761730>]}
[0m03:01:03.556125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3bf96d2-efd9-435c-a87d-fd60284090a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff902532c0>]}
[0m03:01:03.556936 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m03:01:03.562273 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m03:01:03.579453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m03:01:03.579829 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m03:01:03.582964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3bf96d2-efd9-435c-a87d-fd60284090a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90189250>]}
[0m03:01:03.592461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3bf96d2-efd9-435c-a87d-fd60284090a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ff48230>]}
[0m03:01:03.592884 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m03:01:03.593467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bf96d2-efd9-435c-a87d-fd60284090a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90253410>]}
[0m03:01:03.594510 [info ] [MainThread]: 
[0m03:01:03.595453 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m03:01:03.596585 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m03:01:03.602589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m03:01:04.106963 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m03:01:04.110937 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m03:01:04.113822 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m03:01:04.118189 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m03:01:04.123291 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m03:01:04.125291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3bf96d2-efd9-435c-a87d-fd60284090a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90120800>]}
[0m03:01:04.126111 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m03:01:04.128647 [info ] [MainThread]: 
[0m03:01:04.136933 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m03:01:04.137752 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m03:01:04.138866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m03:01:04.139448 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m03:01:04.144378 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m03:01:04.145581 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 03:01:04.139854 => 03:01:04.145405
[0m03:01:04.145983 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m03:01:04.176453 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m03:01:04.180930 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m03:01:04.186295 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m03:01:04.188881 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m03:01:04.191040 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m03:01:04.192115 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m03:01:04.198294 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m03:01:04.205274 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m03:01:04.209964 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m03:01:04.237517 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m03:01:04.241221 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m03:01:04.243374 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 03:01:04.146230 => 03:01:04.243040
[0m03:01:04.246388 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3bf96d2-efd9-435c-a87d-fd60284090a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff82b102c0>]}
[0m03:01:04.247497 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.11s]
[0m03:01:04.249251 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m03:01:04.252333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m03:01:04.252825 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m03:01:04.253181 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m03:01:04.253624 [info ] [MainThread]: 
[0m03:01:04.254162 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m03:01:04.255186 [debug] [MainThread]: Command end result
[0m03:01:04.267647 [info ] [MainThread]: 
[0m03:01:04.268391 [info ] [MainThread]: [32mCompleted successfully[0m
[0m03:01:04.268819 [info ] [MainThread]: 
[0m03:01:04.269211 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m03:01:04.270319 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.85674334, "process_user_time": 2.487914, "process_kernel_time": 0.31454, "process_mem_max_rss": "188684", "process_out_blocks": "1735", "process_in_blocks": "0"}
[0m03:01:04.270833 [debug] [MainThread]: Command `dbt run` succeeded at 03:01:04.270726 after 0.86 seconds
[0m03:01:04.271252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9071d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff71528170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff70ee32f0>]}
[0m03:01:04.271613 [debug] [MainThread]: Flushing usage events
[0m04:11:02.111444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a74f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3e5a690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a751f0>]}


============================== 04:11:02.116273 | 05b00ce5-069d-4a5d-b3ce-08ea8c473fa6 ==============================
[0m04:11:02.116273 [info ] [MainThread]: Running with dbt=1.7.19
[0m04:11:02.118137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:11:02.182202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05b00ce5-069d-4a5d-b3ce-08ea8c473fa6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1a32bd0>]}
[0m04:11:02.183381 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:11:02.190777 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m04:11:02.192170 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.10331454, "process_user_time": 1.38114, "process_kernel_time": 0.224673, "process_mem_max_rss": "104152", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m04:11:02.193259 [debug] [MainThread]: Command `dbt deps` succeeded at 04:11:02.193089 after 0.10 seconds
[0m04:11:02.193884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2d20b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa20b4b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa218b1a0>]}
[0m04:11:02.194433 [debug] [MainThread]: Flushing usage events
[0m04:11:04.766526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a9a81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cbf3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cdfe4e0>]}


============================== 04:11:04.771199 | 1b1c2bdc-32b7-46f3-ac86-22c7b3f47773 ==============================
[0m04:11:04.771199 [info ] [MainThread]: Running with dbt=1.7.19
[0m04:11:04.774137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'send_anonymous_usage_stats': 'True'}
[0m04:11:04.856134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b1c2bdc-32b7-46f3-ac86-22c7b3f47773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b096870>]}
[0m04:11:04.891127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b1c2bdc-32b7-46f3-ac86-22c7b3f47773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a830b00>]}
[0m04:11:04.892139 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m04:11:04.897984 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m04:11:04.916648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:11:04.917179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:11:04.920897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b1c2bdc-32b7-46f3-ac86-22c7b3f47773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a8ebd40>]}
[0m04:11:04.930719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b1c2bdc-32b7-46f3-ac86-22c7b3f47773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a66ff80>]}
[0m04:11:04.931131 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m04:11:04.931792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1c2bdc-32b7-46f3-ac86-22c7b3f47773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b1cccb0>]}
[0m04:11:04.932797 [info ] [MainThread]: 
[0m04:11:04.933525 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m04:11:04.934584 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m04:11:04.942235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:11:05.340055 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m04:11:05.345112 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m04:11:05.348933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m04:11:05.355271 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m04:11:05.360530 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m04:11:05.362526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b1c2bdc-32b7-46f3-ac86-22c7b3f47773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c531eb0>]}
[0m04:11:05.363353 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m04:11:05.364244 [info ] [MainThread]: 
[0m04:11:05.372902 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m04:11:05.373552 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m04:11:05.374399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m04:11:05.374786 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m04:11:05.378267 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m04:11:05.379412 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 04:11:05.375037 => 04:11:05.379254
[0m04:11:05.379768 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m04:11:05.411553 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m04:11:05.416353 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m04:11:05.422074 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m04:11:05.424717 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m04:11:05.427013 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m04:11:05.427972 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m04:11:05.433573 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m04:11:05.436551 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m04:11:05.437903 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m04:11:05.465824 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m04:11:05.470125 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m04:11:05.475130 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 04:11:05.380012 => 04:11:05.474829
[0m04:11:05.479275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b1c2bdc-32b7-46f3-ac86-22c7b3f47773', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a949eb0>]}
[0m04:11:05.480864 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.10s]
[0m04:11:05.484213 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m04:11:05.487516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:11:05.488357 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m04:11:05.489223 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m04:11:05.490085 [info ] [MainThread]: 
[0m04:11:05.491440 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m04:11:05.493587 [debug] [MainThread]: Command end result
[0m04:11:05.516575 [info ] [MainThread]: 
[0m04:11:05.517657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m04:11:05.518203 [info ] [MainThread]: 
[0m04:11:05.518802 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m04:11:05.519906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.77709913, "process_user_time": 2.563833, "process_kernel_time": 0.266856, "process_mem_max_rss": "184972", "process_out_blocks": "1735", "process_in_blocks": "0"}
[0m04:11:05.520592 [debug] [MainThread]: Command `dbt run` succeeded at 04:11:05.520444 after 0.78 seconds
[0m04:11:05.521119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7c5be0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff77a20f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9aab8ef0>]}
[0m04:11:05.524955 [debug] [MainThread]: Flushing usage events
[0m05:03:55.013556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805ab770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8016cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8016d0d0>]}


============================== 05:03:55.019000 | f81dc4f0-963c-41ad-b6cd-7532533c0565 ==============================
[0m05:03:55.019000 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:03:55.020304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m05:03:55.068858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f81dc4f0-963c-41ad-b6cd-7532533c0565', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8058eed0>]}
[0m05:03:55.069577 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:03:55.073016 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m05:03:55.073864 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.08464483, "process_user_time": 1.391119, "process_kernel_time": 0.213018, "process_mem_max_rss": "103916", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m05:03:55.074285 [debug] [MainThread]: Command `dbt deps` succeeded at 05:03:55.074202 after 0.09 seconds
[0m05:03:55.074610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff805ab770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8001eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80047f80>]}
[0m05:03:55.074946 [debug] [MainThread]: Flushing usage events
[0m05:03:57.501203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2a8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaf141be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6e4a40>]}


============================== 05:03:57.505491 | 6dbb51e6-4bc1-48ac-a35f-0aad2c211b01 ==============================
[0m05:03:57.505491 [info ] [MainThread]: Running with dbt=1.7.19
[0m05:03:57.508167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:03:57.621360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dbb51e6-4bc1-48ac-a35f-0aad2c211b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2b3c50>]}
[0m05:03:57.663678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dbb51e6-4bc1-48ac-a35f-0aad2c211b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad6a7230>]}
[0m05:03:57.665020 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m05:03:57.673595 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m05:03:57.709207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m05:03:57.710122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m05:03:57.715845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dbb51e6-4bc1-48ac-a35f-0aad2c211b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1807a0>]}
[0m05:03:57.728630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dbb51e6-4bc1-48ac-a35f-0aad2c211b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacf72f90>]}
[0m05:03:57.729371 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m05:03:57.730063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dbb51e6-4bc1-48ac-a35f-0aad2c211b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad9923f0>]}
[0m05:03:57.731577 [info ] [MainThread]: 
[0m05:03:57.732580 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m05:03:57.733758 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m05:03:57.740409 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:03:58.143733 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m05:03:58.146178 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:03:58.148588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m05:03:58.152767 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m05:03:58.157124 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:03:58.158745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dbb51e6-4bc1-48ac-a35f-0aad2c211b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac291760>]}
[0m05:03:58.159384 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m05:03:58.160797 [info ] [MainThread]: 
[0m05:03:58.167635 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m05:03:58.168437 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m05:03:58.169204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m05:03:58.169570 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m05:03:58.172938 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m05:03:58.173940 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 05:03:58.169822 => 05:03:58.173795
[0m05:03:58.174280 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m05:03:58.215226 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m05:03:58.221054 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:03:58.226273 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m05:03:58.228984 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:03:58.231134 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m05:03:58.232183 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m05:03:58.238374 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m05:03:58.241277 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m05:03:58.242712 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:03:58.256345 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m05:03:58.257693 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m05:03:58.258743 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 05:03:58.174541 => 05:03:58.258604
[0m05:03:58.259433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dbb51e6-4bc1-48ac-a35f-0aad2c211b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dd71d60>]}
[0m05:03:58.259942 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.09s]
[0m05:03:58.260808 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m05:03:58.262157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:03:58.262434 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m05:03:58.262703 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m05:03:58.262995 [info ] [MainThread]: 
[0m05:03:58.263452 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m05:03:58.264154 [debug] [MainThread]: Command end result
[0m05:03:58.270978 [info ] [MainThread]: 
[0m05:03:58.271501 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:03:58.271940 [info ] [MainThread]: 
[0m05:03:58.272282 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:03:58.273159 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.79296, "process_user_time": 2.526761, "process_kernel_time": 0.207555, "process_mem_max_rss": "188972", "process_out_blocks": "1735", "process_in_blocks": "0"}
[0m05:03:58.273617 [debug] [MainThread]: Command `dbt run` succeeded at 05:03:58.273520 after 0.79 seconds
[0m05:03:58.273976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d8f45c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ed8ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0695e0>]}
[0m05:03:58.274310 [debug] [MainThread]: Flushing usage events
[0m06:09:29.284362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e1398b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e577800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e498e90>]}


============================== 06:09:29.289122 | 958cd028-fc0d-442c-a746-fbb1f50f44bf ==============================
[0m06:09:29.289122 [info ] [MainThread]: Running with dbt=1.7.19
[0m06:09:29.290839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:09:29.340717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '958cd028-fc0d-442c-a746-fbb1f50f44bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4969f0>]}
[0m06:09:29.341504 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:09:29.344129 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m06:09:29.344987 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.093336836, "process_user_time": 1.42826, "process_kernel_time": 0.232042, "process_mem_max_rss": "103900", "process_out_blocks": "3", "process_in_blocks": "0"}
[0m06:09:29.345420 [debug] [MainThread]: Command `dbt deps` succeeded at 06:09:29.345332 after 0.09 seconds
[0m06:09:29.345741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e92ddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e13ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e534dd0>]}
[0m06:09:29.346056 [debug] [MainThread]: Flushing usage events
[0m06:09:31.601403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb329c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51a5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb329c8c0>]}


============================== 06:09:31.606263 | f3c94a4d-2554-4553-8eac-9c585c765542 ==============================
[0m06:09:31.606263 [info ] [MainThread]: Running with dbt=1.7.19
[0m06:09:31.608022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:09:31.686210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3c94a4d-2554-4553-8eac-9c585c765542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb329d520>]}
[0m06:09:31.713682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3c94a4d-2554-4553-8eac-9c585c765542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb329d520>]}
[0m06:09:31.714272 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m06:09:31.719323 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m06:09:31.735489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:09:31.735875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:09:31.738934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3c94a4d-2554-4553-8eac-9c585c765542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb309cd70>]}
[0m06:09:31.748702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3c94a4d-2554-4553-8eac-9c585c765542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2f9c080>]}
[0m06:09:31.749080 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m06:09:31.749668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c94a4d-2554-4553-8eac-9c585c765542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3b2f080>]}
[0m06:09:31.750632 [info ] [MainThread]: 
[0m06:09:31.751401 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m06:09:31.752193 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m06:09:31.760941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:09:32.153798 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m06:09:32.157043 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m06:09:32.160665 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__analytics'
[0m06:09:32.166655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:09:32.185162 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m06:09:32.188908 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m06:09:32.190918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3c94a4d-2554-4553-8eac-9c585c765542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb325a420>]}
[0m06:09:32.191665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m06:09:32.192610 [info ] [MainThread]: 
[0m06:09:32.199919 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m06:09:32.200470 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m06:09:32.201221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m06:09:32.201620 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m06:09:32.205123 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m06:09:32.206199 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 06:09:32.201903 => 06:09:32.206042
[0m06:09:32.206580 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m06:09:32.243326 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m06:09:32.247740 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m06:09:32.253043 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m06:09:32.255708 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m06:09:32.258521 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m06:09:32.259714 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m06:09:32.267788 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m06:09:32.272084 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m06:09:32.275752 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m06:09:32.291603 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m06:09:32.293017 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m06:09:32.294077 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 06:09:32.206850 => 06:09:32.293925
[0m06:09:32.294804 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3c94a4d-2554-4553-8eac-9c585c765542', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94eb3800>]}
[0m06:09:32.295335 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.09s]
[0m06:09:32.296076 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m06:09:32.297641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:09:32.297938 [debug] [MainThread]: Connection 'list_' was left open.
[0m06:09:32.298231 [debug] [MainThread]: On list_: Close
[0m06:09:32.298517 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m06:09:32.298799 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m06:09:32.299162 [info ] [MainThread]: 
[0m06:09:32.299480 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m06:09:32.300078 [debug] [MainThread]: Command end result
[0m06:09:32.307069 [info ] [MainThread]: 
[0m06:09:32.307636 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:09:32.308008 [info ] [MainThread]: 
[0m06:09:32.308416 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:09:32.309315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.73112315, "process_user_time": 2.396438, "process_kernel_time": 0.243773, "process_mem_max_rss": "186544", "process_out_blocks": "1735", "process_in_blocks": "0"}
[0m06:09:32.309765 [debug] [MainThread]: Command `dbt run` succeeded at 06:09:32.309667 after 0.73 seconds
[0m06:09:32.310110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb38dc9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1fdf3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ece270>]}
[0m06:09:32.310515 [debug] [MainThread]: Flushing usage events
[0m07:00:25.083366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cba8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9908f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8effe1e0>]}


============================== 07:00:25.093688 | 2cd939ad-649a-4975-b28a-6e499b2d78ff ==============================
[0m07:00:25.093688 [info ] [MainThread]: Running with dbt=1.7.19
[0m07:00:25.094617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:00:25.502264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cd939ad-649a-4975-b28a-6e499b2d78ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccabd10>]}
[0m07:00:25.534736 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m07:00:25.599993 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m07:00:25.638073 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.64854217, "process_user_time": 2.011484, "process_kernel_time": 0.673929, "process_mem_max_rss": "103052", "process_in_blocks": "93088", "process_out_blocks": "3"}
[0m07:00:25.672710 [debug] [MainThread]: Command `dbt deps` succeeded at 07:00:25.670309 after 0.68 seconds
[0m07:00:25.689998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d9908f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cfa5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d0c1ca0>]}
[0m07:00:25.694036 [debug] [MainThread]: Flushing usage events
[0m07:00:29.281105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e70cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ebbffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8eb09f70>]}


============================== 07:00:29.291537 | ad673230-ab06-4160-93bb-6532f6c542be ==============================
[0m07:00:29.291537 [info ] [MainThread]: Running with dbt=1.7.19
[0m07:00:29.296664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:00:29.520379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad673230-ab06-4160-93bb-6532f6c542be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec65520>]}
[0m07:00:29.554243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad673230-ab06-4160-93bb-6532f6c542be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e822a80>]}
[0m07:00:29.555264 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m07:00:29.561991 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m07:00:29.590961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:00:29.591414 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:00:29.595230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad673230-ab06-4160-93bb-6532f6c542be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4ceea0>]}
[0m07:00:29.608838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad673230-ab06-4160-93bb-6532f6c542be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4111f0>]}
[0m07:00:29.609686 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m07:00:29.611947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad673230-ab06-4160-93bb-6532f6c542be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e6cb6b0>]}
[0m07:00:29.619117 [info ] [MainThread]: 
[0m07:00:29.623411 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m07:00:29.628697 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m07:00:29.650146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:30.853506 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m07:00:30.856248 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:00:30.859731 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__analytics'
[0m07:00:30.865898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:00:30.908710 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m07:00:30.954499 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m07:00:30.957697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad673230-ab06-4160-93bb-6532f6c542be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b56fb00>]}
[0m07:00:30.958981 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:00:30.962990 [info ] [MainThread]: 
[0m07:00:30.973791 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m07:00:30.974483 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m07:00:30.975689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m07:00:30.976112 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m07:00:30.980644 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m07:00:30.982213 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 07:00:30.976386 => 07:00:30.982027
[0m07:00:30.982600 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m07:00:31.052455 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m07:00:31.062589 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:00:31.068834 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m07:00:31.076419 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m07:00:31.079087 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m07:00:31.080409 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m07:00:31.128489 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m07:00:31.133791 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m07:00:31.138234 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:00:31.156821 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m07:00:31.158791 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m07:00:31.160237 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 07:00:30.982865 => 07:00:31.160040
[0m07:00:31.161474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad673230-ab06-4160-93bb-6532f6c542be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6b244530>]}
[0m07:00:31.162484 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.19s]
[0m07:00:31.163905 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m07:00:31.166121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:00:31.166646 [debug] [MainThread]: Connection 'list_' was left open.
[0m07:00:31.166952 [debug] [MainThread]: On list_: Close
[0m07:00:31.167575 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m07:00:31.168022 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m07:00:31.168658 [info ] [MainThread]: 
[0m07:00:31.169326 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m07:00:31.170485 [debug] [MainThread]: Command end result
[0m07:00:31.179434 [info ] [MainThread]: 
[0m07:00:31.180098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:00:31.180533 [info ] [MainThread]: 
[0m07:00:31.181059 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:00:31.182787 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9532102, "process_user_time": 3.514921, "process_kernel_time": 0.534408, "process_mem_max_rss": "184420", "process_in_blocks": "70184", "process_out_blocks": "1735"}
[0m07:00:31.183378 [debug] [MainThread]: Command `dbt run` succeeded at 07:00:31.183273 after 1.95 seconds
[0m07:00:31.183889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ec6a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87ffb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87f6a570>]}
[0m07:00:31.184256 [debug] [MainThread]: Flushing usage events
[0m08:00:24.161893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959aa390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95aab860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95aabf80>]}


============================== 08:00:24.172096 | d1b88752-6e52-418e-b7ee-391487f081f7 ==============================
[0m08:00:24.172096 [info ] [MainThread]: Running with dbt=1.7.19
[0m08:00:24.173115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:00:24.304356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1b88752-6e52-418e-b7ee-391487f081f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff959663c0>]}
[0m08:00:24.305424 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:00:24.307968 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m08:00:24.309596 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19474246, "process_user_time": 2.300239, "process_kernel_time": 0.480551, "process_mem_max_rss": "103180", "process_in_blocks": "96240", "process_out_blocks": "3"}
[0m08:00:24.310129 [debug] [MainThread]: Command `dbt deps` succeeded at 08:00:24.310010 after 0.20 seconds
[0m08:00:24.310575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95e7c740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95ebf230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97d8df40>]}
[0m08:00:24.311018 [debug] [MainThread]: Flushing usage events
[0m08:00:27.267771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a978440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a979b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9787d0>]}


============================== 08:00:27.272887 | 2ed25b5e-debf-4f98-b1ea-25296e8baecd ==============================
[0m08:00:27.272887 [info ] [MainThread]: Running with dbt=1.7.19
[0m08:00:27.273479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:00:27.361845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ed25b5e-debf-4f98-b1ea-25296e8baecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b16de80>]}
[0m08:00:27.402253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ed25b5e-debf-4f98-b1ea-25296e8baecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a9787d0>]}
[0m08:00:27.403115 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m08:00:27.409330 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m08:00:27.434994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:27.435390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:27.438495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ed25b5e-debf-4f98-b1ea-25296e8baecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7a6c30>]}
[0m08:00:27.448816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ed25b5e-debf-4f98-b1ea-25296e8baecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a63c3e0>]}
[0m08:00:27.449233 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m08:00:27.449851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed25b5e-debf-4f98-b1ea-25296e8baecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8aa272c0>]}
[0m08:00:27.450850 [info ] [MainThread]: 
[0m08:00:27.451657 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m08:00:27.452597 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m08:00:27.459021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:28.202157 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m08:00:28.206915 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:28.212262 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m08:00:28.219827 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m08:00:28.238040 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:00:28.240518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ed25b5e-debf-4f98-b1ea-25296e8baecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a774740>]}
[0m08:00:28.241576 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:00:28.243201 [info ] [MainThread]: 
[0m08:00:28.252006 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m08:00:28.252720 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m08:00:28.253785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m08:00:28.254199 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m08:00:28.258257 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m08:00:28.259629 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 08:00:28.254483 => 08:00:28.259469
[0m08:00:28.260003 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m08:00:28.308101 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m08:00:28.320511 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m08:00:28.326588 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m08:00:28.331040 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:28.333975 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m08:00:28.335672 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m08:00:28.354905 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m08:00:28.361932 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m08:00:28.364797 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:28.381203 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m08:00:28.383550 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m08:00:28.385023 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 08:00:28.260239 => 08:00:28.384865
[0m08:00:28.385922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ed25b5e-debf-4f98-b1ea-25296e8baecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff672f06b0>]}
[0m08:00:28.386575 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.13s]
[0m08:00:28.389046 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m08:00:28.391449 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:28.391910 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m08:00:28.392261 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m08:00:28.392701 [info ] [MainThread]: 
[0m08:00:28.393428 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.94 seconds (0.94s).
[0m08:00:28.394229 [debug] [MainThread]: Command end result
[0m08:00:28.404358 [info ] [MainThread]: 
[0m08:00:28.405335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:00:28.405952 [info ] [MainThread]: 
[0m08:00:28.406646 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:00:28.408082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1665219, "process_user_time": 2.71252, "process_kernel_time": 0.364218, "process_mem_max_rss": "184240", "process_in_blocks": "93120", "process_out_blocks": "1735"}
[0m08:00:28.408788 [debug] [MainThread]: Command `dbt run` succeeded at 08:00:28.408644 after 1.17 seconds
[0m08:00:28.409342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b249220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bc8cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c5de960>]}
[0m08:00:28.409846 [debug] [MainThread]: Flushing usage events
[0m09:00:23.763160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b797d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bcad6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7962a0>]}


============================== 09:00:23.768564 | 147ff37a-e9a6-4b8f-85b8-014850802ad9 ==============================
[0m09:00:23.768564 [info ] [MainThread]: Running with dbt=1.7.19
[0m09:00:23.772485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m09:00:23.866400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '147ff37a-e9a6-4b8f-85b8-014850802ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b88ad20>]}
[0m09:00:23.867725 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:00:23.870145 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:00:23.871314 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.13340966, "process_user_time": 1.615032, "process_kernel_time": 0.304531, "process_mem_max_rss": "103172", "process_in_blocks": "87640", "process_out_blocks": "3"}
[0m09:00:23.871766 [debug] [MainThread]: Command `dbt deps` succeeded at 09:00:23.871658 after 0.13 seconds
[0m09:00:23.872114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b7db440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b687b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b686ab0>]}
[0m09:00:23.872474 [debug] [MainThread]: Flushing usage events
[0m09:00:26.251881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44f5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44f7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44f57f0>]}


============================== 09:00:26.256158 | 3243201e-8843-4216-9a20-7e8a3bacc0c6 ==============================
[0m09:00:26.256158 [info ] [MainThread]: Running with dbt=1.7.19
[0m09:00:26.257926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'send_anonymous_usage_stats': 'True'}
[0m09:00:26.339338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3243201e-8843-4216-9a20-7e8a3bacc0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a51520>]}
[0m09:00:26.367301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3243201e-8843-4216-9a20-7e8a3bacc0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa44f6d80>]}
[0m09:00:26.368011 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m09:00:26.373701 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m09:00:26.399197 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:00:26.403553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:00:26.408151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3243201e-8843-4216-9a20-7e8a3bacc0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa4a1f0e0>]}
[0m09:00:26.424421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3243201e-8843-4216-9a20-7e8a3bacc0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa420b800>]}
[0m09:00:26.425055 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m09:00:26.425610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3243201e-8843-4216-9a20-7e8a3bacc0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa463b260>]}
[0m09:00:26.426909 [info ] [MainThread]: 
[0m09:00:26.427618 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m09:00:26.429078 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m09:00:26.440121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:27.044610 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m09:00:27.046759 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:00:27.049430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m09:00:27.053770 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m09:00:27.073183 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m09:00:27.075050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3243201e-8843-4216-9a20-7e8a3bacc0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff860caa80>]}
[0m09:00:27.075792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:00:27.076722 [info ] [MainThread]: 
[0m09:00:27.084144 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m09:00:27.084643 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m09:00:27.085363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m09:00:27.085752 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m09:00:27.089150 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m09:00:27.090203 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 09:00:27.086001 => 09:00:27.090058
[0m09:00:27.090552 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m09:00:27.121335 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m09:00:27.128613 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m09:00:27.134019 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m09:00:27.139383 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:00:27.141969 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m09:00:27.143093 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m09:00:27.169180 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m09:00:27.174187 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m09:00:27.177476 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:00:27.195969 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m09:00:27.197682 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m09:00:27.198921 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 09:00:27.090781 => 09:00:27.198704
[0m09:00:27.199781 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3243201e-8843-4216-9a20-7e8a3bacc0c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff84f24ef0>]}
[0m09:00:27.200419 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.11s]
[0m09:00:27.201212 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m09:00:27.202898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:00:27.203248 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m09:00:27.203575 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m09:00:27.204025 [info ] [MainThread]: 
[0m09:00:27.204536 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m09:00:27.205245 [debug] [MainThread]: Command end result
[0m09:00:27.212048 [info ] [MainThread]: 
[0m09:00:27.212612 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:00:27.213020 [info ] [MainThread]: 
[0m09:00:27.213376 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:00:27.214439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.988992, "process_user_time": 2.477986, "process_kernel_time": 0.288913, "process_mem_max_rss": "186440", "process_in_blocks": "47608", "process_out_blocks": "1735"}
[0m09:00:27.214934 [debug] [MainThread]: Command `dbt run` succeeded at 09:00:27.214821 after 0.99 seconds
[0m09:00:27.215314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa931b3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8561a780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa42d4380>]}
[0m09:00:27.215682 [debug] [MainThread]: Flushing usage events
[0m10:00:26.697802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3d8e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8d901c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8516a0>]}


============================== 10:00:26.703732 | 49330fe6-5135-44b2-a61f-2751a4a874e7 ==============================
[0m10:00:26.703732 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:00:26.707317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:00:26.812130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49330fe6-5135-44b2-a61f-2751a4a874e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c3d8590>]}
[0m10:00:26.812954 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:00:26.815628 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m10:00:26.818071 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14719029, "process_user_time": 1.676378, "process_kernel_time": 0.323423, "process_mem_max_rss": "103280", "process_in_blocks": "95792", "process_out_blocks": "3"}
[0m10:00:26.818663 [debug] [MainThread]: Command `dbt deps` succeeded at 10:00:26.818550 after 0.15 seconds
[0m10:00:26.819137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c48a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c286ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c2b3bc0>]}
[0m10:00:26.819526 [debug] [MainThread]: Flushing usage events
[0m10:00:29.691893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb79972c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ef1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e53740>]}


============================== 10:00:29.696441 | bcda5269-d62c-41ee-8329-0bc347d40246 ==============================
[0m10:00:29.696441 [info ] [MainThread]: Running with dbt=1.7.19
[0m10:00:29.700168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:00:29.799304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bcda5269-d62c-41ee-8329-0bc347d40246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7944560>]}
[0m10:00:29.836734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bcda5269-d62c-41ee-8329-0bc347d40246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7a874a0>]}
[0m10:00:29.837920 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m10:00:29.845548 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m10:00:29.876508 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:00:29.877320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:00:29.882616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bcda5269-d62c-41ee-8329-0bc347d40246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77dedb0>]}
[0m10:00:29.896696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bcda5269-d62c-41ee-8329-0bc347d40246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb769f020>]}
[0m10:00:29.897355 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m10:00:29.898247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcda5269-d62c-41ee-8329-0bc347d40246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ef2f60>]}
[0m10:00:29.899546 [info ] [MainThread]: 
[0m10:00:29.900708 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m10:00:29.903842 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m10:00:29.925027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:31.224563 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m10:00:31.228849 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:00:31.233701 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m10:00:31.240724 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m10:00:31.258530 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:00:31.260701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bcda5269-d62c-41ee-8329-0bc347d40246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff987b9280>]}
[0m10:00:31.261760 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:00:31.265223 [info ] [MainThread]: 
[0m10:00:31.290355 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m10:00:31.291684 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m10:00:31.292779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m10:00:31.293220 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m10:00:31.297671 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m10:00:31.299360 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 10:00:31.293568 => 10:00:31.299169
[0m10:00:31.299773 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m10:00:31.336256 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m10:00:31.346794 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:00:31.353261 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m10:00:31.363845 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m10:00:31.368573 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m10:00:31.370088 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m10:00:31.389906 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m10:00:31.394339 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m10:00:31.398304 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:00:31.424708 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m10:00:31.426839 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m10:00:31.428063 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 10:00:31.300099 => 10:00:31.427905
[0m10:00:31.428817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bcda5269-d62c-41ee-8329-0bc347d40246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98527a70>]}
[0m10:00:31.429332 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.14s]
[0m10:00:31.430235 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m10:00:31.431964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:31.432358 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m10:00:31.432683 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m10:00:31.433112 [info ] [MainThread]: 
[0m10:00:31.433616 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.53 seconds (1.53s).
[0m10:00:31.434309 [debug] [MainThread]: Command end result
[0m10:00:31.441846 [info ] [MainThread]: 
[0m10:00:31.442443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:00:31.442922 [info ] [MainThread]: 
[0m10:00:31.443496 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:00:31.444962 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7779874, "process_user_time": 3.031356, "process_kernel_time": 0.555799, "process_mem_max_rss": "184016", "process_in_blocks": "93144", "process_out_blocks": "1735"}
[0m10:00:31.445516 [debug] [MainThread]: Command `dbt run` succeeded at 10:00:31.445398 after 1.78 seconds
[0m10:00:31.445956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff986e3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e533b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e53740>]}
[0m10:00:31.446291 [debug] [MainThread]: Flushing usage events
[0m11:13:01.392356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d604a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f68590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d6049b0>]}


============================== 11:13:01.399926 | 497caa72-f143-47a1-93ee-6e4f9438839a ==============================
[0m11:13:01.399926 [info ] [MainThread]: Running with dbt=1.7.19
[0m11:13:01.404000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:13:01.507443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '497caa72-f143-47a1-93ee-6e4f9438839a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e386d20>]}
[0m11:13:01.508769 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:13:01.512209 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:13:01.515560 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15556554, "process_user_time": 2.604467, "process_kernel_time": 0.631385, "process_mem_max_rss": "103228", "process_in_blocks": "95368", "process_out_blocks": "3"}
[0m11:13:01.517562 [debug] [MainThread]: Command `dbt deps` succeeded at 11:13:01.516955 after 0.16 seconds
[0m11:13:01.518309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9db68b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa229e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d4df5f0>]}
[0m11:13:01.518948 [debug] [MainThread]: Flushing usage events
[0m11:13:05.130925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a35d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b447fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a873410>]}


============================== 11:13:05.137286 | 3affb7a3-2328-47ba-ad9e-924a5869a731 ==============================
[0m11:13:05.137286 [info ] [MainThread]: Running with dbt=1.7.19
[0m11:13:05.138008 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:13:05.309556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3affb7a3-2328-47ba-ad9e-924a5869a731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a3670b0>]}
[0m11:13:05.362629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3affb7a3-2328-47ba-ad9e-924a5869a731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a4706e0>]}
[0m11:13:05.364285 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m11:13:05.384174 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m11:13:05.413816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:13:05.414347 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:13:05.419432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3affb7a3-2328-47ba-ad9e-924a5869a731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a157620>]}
[0m11:13:05.431977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3affb7a3-2328-47ba-ad9e-924a5869a731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a0200b0>]}
[0m11:13:05.432464 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m11:13:05.433213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3affb7a3-2328-47ba-ad9e-924a5869a731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a31b380>]}
[0m11:13:05.434799 [info ] [MainThread]: 
[0m11:13:05.435671 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m11:13:05.438566 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m11:13:05.450963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:13:06.657863 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m11:13:06.661914 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:13:06.665969 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m11:13:06.672050 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m11:13:06.688124 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:13:06.690235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3affb7a3-2328-47ba-ad9e-924a5869a731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff5cb1d2e0>]}
[0m11:13:06.691204 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:13:06.694939 [info ] [MainThread]: 
[0m11:13:06.705094 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m11:13:06.705834 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m11:13:06.706869 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m11:13:06.707258 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m11:13:06.711316 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m11:13:06.714362 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 11:13:06.707546 => 11:13:06.714164
[0m11:13:06.714778 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m11:13:06.770885 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m11:13:06.784543 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:13:06.793994 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m11:13:06.805410 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m11:13:06.809127 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m11:13:06.812254 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m11:13:06.835053 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m11:13:06.838430 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m11:13:06.840697 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:13:06.856197 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m11:13:06.858030 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m11:13:06.859382 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 11:13:06.715073 => 11:13:06.859195
[0m11:13:06.860176 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3affb7a3-2328-47ba-ad9e-924a5869a731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff56d2b620>]}
[0m11:13:06.860854 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.15s]
[0m11:13:06.861779 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m11:13:06.863522 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:13:06.863833 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m11:13:06.864090 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m11:13:06.864421 [info ] [MainThread]: 
[0m11:13:06.864975 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m11:13:06.865554 [debug] [MainThread]: Command end result
[0m11:13:06.889410 [info ] [MainThread]: 
[0m11:13:06.891260 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:13:06.892857 [info ] [MainThread]: 
[0m11:13:06.894409 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:13:06.897944 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.809139, "process_user_time": 3.227578, "process_kernel_time": 0.607198, "process_mem_max_rss": "183688", "process_in_blocks": "92808", "process_out_blocks": "1735"}
[0m11:13:06.899194 [debug] [MainThread]: Command `dbt run` succeeded at 11:13:06.899033 after 1.81 seconds
[0m11:13:06.900853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7b447fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff57de5eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7a0f9160>]}
[0m11:13:06.901759 [debug] [MainThread]: Flushing usage events
[0m12:05:51.282548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fc762d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa00ef080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd22f30>]}


============================== 12:05:51.288954 | 66959bed-b4a4-433d-9198-50bc48f83353 ==============================
[0m12:05:51.288954 [info ] [MainThread]: Running with dbt=1.7.19
[0m12:05:51.293169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:05:51.417379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66959bed-b4a4-433d-9198-50bc48f83353', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0468320>]}
[0m12:05:51.418256 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:05:51.420616 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:05:51.421805 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17336437, "process_user_time": 2.126424, "process_kernel_time": 0.505369, "process_mem_max_rss": "103452", "process_in_blocks": "68496", "process_out_blocks": "3"}
[0m12:05:51.422280 [debug] [MainThread]: Command `dbt deps` succeeded at 12:05:51.422169 after 0.17 seconds
[0m12:05:51.422639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9fd77440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa018d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0149520>]}
[0m12:05:51.422999 [debug] [MainThread]: Flushing usage events
[0m12:05:54.962717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938ce090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d0acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93de5850>]}


============================== 12:05:54.967752 | f75ed517-8d8c-45f0-9a08-23885bc527a0 ==============================
[0m12:05:54.967752 [info ] [MainThread]: Running with dbt=1.7.19
[0m12:05:54.971861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'send_anonymous_usage_stats': 'True'}
[0m12:05:55.076745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f75ed517-8d8c-45f0-9a08-23885bc527a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9388b7a0>]}
[0m12:05:55.105968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f75ed517-8d8c-45f0-9a08-23885bc527a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938d7c20>]}
[0m12:05:55.106766 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m12:05:55.112814 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m12:05:55.160783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:55.161381 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:55.165641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f75ed517-8d8c-45f0-9a08-23885bc527a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9368f320>]}
[0m12:05:55.181155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f75ed517-8d8c-45f0-9a08-23885bc527a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93597c80>]}
[0m12:05:55.181744 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m12:05:55.182690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f75ed517-8d8c-45f0-9a08-23885bc527a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d47080>]}
[0m12:05:55.184310 [info ] [MainThread]: 
[0m12:05:55.185780 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m12:05:55.187751 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m12:05:55.201502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:56.156306 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m12:05:56.158757 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:05:56.162458 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list__analytics'
[0m12:05:56.167407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:56.209556 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m12:05:56.282596 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.07 seconds
[0m12:05:56.285442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f75ed517-8d8c-45f0-9a08-23885bc527a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93fb6270>]}
[0m12:05:56.286541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:56.290554 [info ] [MainThread]: 
[0m12:05:56.302231 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m12:05:56.302984 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m12:05:56.303935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m12:05:56.304335 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m12:05:56.308745 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m12:05:56.310206 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 12:05:56.304616 => 12:05:56.310010
[0m12:05:56.310655 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m12:05:56.364890 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m12:05:56.374025 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:05:56.380122 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m12:05:56.387173 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m12:05:56.391713 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m12:05:56.393974 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m12:05:56.438906 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.04 seconds
[0m12:05:56.445355 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m12:05:56.449938 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:05:56.469194 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m12:05:56.471171 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m12:05:56.472590 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 12:05:56.310899 => 12:05:56.472355
[0m12:05:56.473512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f75ed517-8d8c-45f0-9a08-23885bc527a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6ff10170>]}
[0m12:05:56.474343 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.17s]
[0m12:05:56.475362 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m12:05:56.477480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:56.477901 [debug] [MainThread]: Connection 'list_' was left open.
[0m12:05:56.478219 [debug] [MainThread]: On list_: Close
[0m12:05:56.478543 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m12:05:56.478925 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m12:05:56.479475 [info ] [MainThread]: 
[0m12:05:56.480115 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.29 seconds (1.29s).
[0m12:05:56.480870 [debug] [MainThread]: Command end result
[0m12:05:56.489378 [info ] [MainThread]: 
[0m12:05:56.490106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:05:56.490546 [info ] [MainThread]: 
[0m12:05:56.491103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:05:56.493073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5598795, "process_user_time": 3.293868, "process_kernel_time": 0.577191, "process_mem_max_rss": "184980", "process_in_blocks": "2960", "process_out_blocks": "1735"}
[0m12:05:56.493689 [debug] [MainThread]: Command `dbt run` succeeded at 12:05:56.493553 after 1.56 seconds
[0m12:05:56.494181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff942b2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff74a314c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff754b18e0>]}
[0m12:05:56.494528 [debug] [MainThread]: Flushing usage events
[0m13:01:00.914312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c3a540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c38410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c38320>]}


============================== 13:01:00.921470 | 85ed10ab-1029-460c-95e1-0124e3bbbadf ==============================
[0m13:01:00.921470 [info ] [MainThread]: Running with dbt=1.7.19
[0m13:01:00.922161 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:01:01.051643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85ed10ab-1029-460c-95e1-0124e3bbbadf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ae6a80>]}
[0m13:01:01.052466 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:01:01.054496 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:01:01.055874 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.17922929, "process_user_time": 1.935107, "process_kernel_time": 0.399179, "process_mem_max_rss": "103176", "process_in_blocks": "99040", "process_out_blocks": "3"}
[0m13:01:01.056351 [debug] [MainThread]: Command `dbt deps` succeeded at 13:01:01.056229 after 0.18 seconds
[0m13:01:01.056716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ce4f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa40375c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3ae6a80>]}
[0m13:01:01.057039 [debug] [MainThread]: Flushing usage events
[0m13:01:04.891660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8387a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae78a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a838b00>]}


============================== 13:01:04.898545 | 831158cb-e51e-4697-bec7-5966a313555f ==============================
[0m13:01:04.898545 [info ] [MainThread]: Running with dbt=1.7.19
[0m13:01:04.902858 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:05.036466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '831158cb-e51e-4697-bec7-5966a313555f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b05ef30>]}
[0m13:01:05.068121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '831158cb-e51e-4697-bec7-5966a313555f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a6eb890>]}
[0m13:01:05.069023 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m13:01:05.075852 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m13:01:05.101080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:05.101502 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:05.104998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '831158cb-e51e-4697-bec7-5966a313555f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8e4c80>]}
[0m13:01:05.120584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '831158cb-e51e-4697-bec7-5966a313555f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a53cfb0>]}
[0m13:01:05.121446 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m13:01:05.123078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '831158cb-e51e-4697-bec7-5966a313555f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8383b0>]}
[0m13:01:05.125276 [info ] [MainThread]: 
[0m13:01:05.126402 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m13:01:05.127526 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m13:01:05.135029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:06.356102 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m13:01:06.365218 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:01:06.372060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m13:01:06.379162 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m13:01:06.403747 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m13:01:06.407819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '831158cb-e51e-4697-bec7-5966a313555f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a5d80b0>]}
[0m13:01:06.410956 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:01:06.414556 [info ] [MainThread]: 
[0m13:01:06.427543 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m13:01:06.428489 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m13:01:06.430041 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m13:01:06.430477 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m13:01:06.435489 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m13:01:06.437172 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 13:01:06.430769 => 13:01:06.436948
[0m13:01:06.437628 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m13:01:06.494001 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m13:01:06.502402 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:01:06.508974 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m13:01:06.517386 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m13:01:06.525004 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m13:01:06.526616 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m13:01:06.560224 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m13:01:06.571966 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m13:01:06.575561 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:01:06.595012 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m13:01:06.596933 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m13:01:06.598447 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 13:01:06.437891 => 13:01:06.598191
[0m13:01:06.599538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '831158cb-e51e-4697-bec7-5966a313555f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd7bcb0>]}
[0m13:01:06.600313 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.17s]
[0m13:01:06.601364 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m13:01:06.603641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:06.604076 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m13:01:06.604475 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m13:01:06.605041 [info ] [MainThread]: 
[0m13:01:06.605680 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.48 seconds (1.48s).
[0m13:01:06.606464 [debug] [MainThread]: Command end result
[0m13:01:06.615918 [info ] [MainThread]: 
[0m13:01:06.616657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:06.617100 [info ] [MainThread]: 
[0m13:01:06.617601 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:01:06.619431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7670289, "process_user_time": 3.475104, "process_kernel_time": 0.651918, "process_mem_max_rss": "184220", "process_in_blocks": "97960", "process_out_blocks": "1735"}
[0m13:01:06.620218 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:06.620086 after 1.77 seconds
[0m13:01:06.621124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8ead50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c2e35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff6c30d8b0>]}
[0m13:01:06.621661 [debug] [MainThread]: Flushing usage events
[0m14:05:48.721573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cc1880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0c47fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2c2dee0>]}


============================== 14:05:48.728313 | 7a20a988-0df9-49f0-8816-db8d8d8c7433 ==============================
[0m14:05:48.728313 [info ] [MainThread]: Running with dbt=1.7.19
[0m14:05:48.732376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:48.856967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a20a988-0df9-49f0-8816-db8d8d8c7433', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb0cc0170>]}
[0m14:05:48.862128 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:05:48.867754 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:05:48.873055 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.18038629, "process_user_time": 2.047284, "process_kernel_time": 0.437333, "process_mem_max_rss": "103732", "process_in_blocks": "96848", "process_out_blocks": "3"}
[0m14:05:48.874995 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:48.874790 after 0.18 seconds
[0m14:05:48.875902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08f74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb10daf00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb08fa180>]}
[0m14:05:48.876377 [debug] [MainThread]: Flushing usage events
[0m14:05:52.310270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb83d19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb84cffe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88b27e0>]}


============================== 14:05:52.315060 | cf5e3643-5ccf-4daf-9868-3414363d3fd4 ==============================
[0m14:05:52.315060 [info ] [MainThread]: Running with dbt=1.7.19
[0m14:05:52.318634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:52.420263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cf5e3643-5ccf-4daf-9868-3414363d3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8337890>]}
[0m14:05:52.449110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cf5e3643-5ccf-4daf-9868-3414363d3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a0ce90>]}
[0m14:05:52.449939 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m14:05:52.456716 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m14:05:52.483114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:52.483573 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:52.487024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cf5e3643-5ccf-4daf-9868-3414363d3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb838e180>]}
[0m14:05:52.497035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cf5e3643-5ccf-4daf-9868-3414363d3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8097b00>]}
[0m14:05:52.497535 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m14:05:52.498103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf5e3643-5ccf-4daf-9868-3414363d3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8847530>]}
[0m14:05:52.499153 [info ] [MainThread]: 
[0m14:05:52.500090 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m14:05:52.501037 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m14:05:52.508494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:53.434884 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m14:05:53.438721 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m14:05:53.442333 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m14:05:53.448738 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m14:05:53.496821 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.05 seconds
[0m14:05:53.499901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cf5e3643-5ccf-4daf-9868-3414363d3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98f2bb90>]}
[0m14:05:53.501103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:53.505252 [info ] [MainThread]: 
[0m14:05:53.517465 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m14:05:53.518166 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m14:05:53.519198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m14:05:53.519596 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m14:05:53.524529 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m14:05:53.526332 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 14:05:53.519944 => 14:05:53.526040
[0m14:05:53.526884 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m14:05:53.578449 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m14:05:53.586057 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:05:53.592555 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m14:05:53.598171 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m14:05:53.601561 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m14:05:53.603007 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m14:05:53.633347 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m14:05:53.639766 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m14:05:53.643508 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m14:05:53.661924 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m14:05:53.663920 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m14:05:53.665424 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 14:05:53.527189 => 14:05:53.665245
[0m14:05:53.666389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cf5e3643-5ccf-4daf-9868-3414363d3fd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a011ee0>]}
[0m14:05:53.667067 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.15s]
[0m14:05:53.667970 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m14:05:53.670150 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:53.670704 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m14:05:53.671114 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m14:05:53.671623 [info ] [MainThread]: 
[0m14:05:53.672376 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m14:05:53.673234 [debug] [MainThread]: Command end result
[0m14:05:53.682156 [info ] [MainThread]: 
[0m14:05:53.683204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:53.683735 [info ] [MainThread]: 
[0m14:05:53.684355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:05:53.686236 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4000314, "process_user_time": 3.067213, "process_kernel_time": 0.467742, "process_mem_max_rss": "184556", "process_in_blocks": "51208", "process_out_blocks": "1735"}
[0m14:05:53.686921 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:53.686795 after 1.40 seconds
[0m14:05:53.687462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb88a0620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99122e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9a174200>]}
[0m14:05:53.688187 [debug] [MainThread]: Flushing usage events
[0m15:51:34.319996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2908a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2908e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2909df0>]}


============================== 15:51:34.325428 | 6357d535-099f-40a8-9825-eea889bab3bf ==============================
[0m15:51:34.325428 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:51:34.328986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:34.436506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6357d535-099f-40a8-9825-eea889bab3bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2912de0>]}
[0m15:51:34.437294 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:51:34.439228 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:51:34.440856 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.14606425, "process_user_time": 1.807255, "process_kernel_time": 0.335047, "process_mem_max_rss": "103416", "process_in_blocks": "91160", "process_out_blocks": "3"}
[0m15:51:34.441343 [debug] [MainThread]: Command `dbt deps` succeeded at 15:51:34.441231 after 0.15 seconds
[0m15:51:34.441743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2909a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2908140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2912de0>]}
[0m15:51:34.442107 [debug] [MainThread]: Flushing usage events
[0m15:51:38.028241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0238ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0751610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0751bb0>]}


============================== 15:51:38.044400 | 8993ece6-a9e3-487e-8a8e-6725512b78a2 ==============================
[0m15:51:38.044400 [info ] [MainThread]: Running with dbt=1.7.19
[0m15:51:38.050179 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/project/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:51:38.222552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8993ece6-a9e3-487e-8a8e-6725512b78a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0a34cb0>]}
[0m15:51:38.271687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8993ece6-a9e3-487e-8a8e-6725512b78a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0111610>]}
[0m15:51:38.275271 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m15:51:38.288451 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m15:51:38.334770 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:38.335386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:38.340447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8993ece6-a9e3-487e-8a8e-6725512b78a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa02bcd10>]}
[0m15:51:38.355604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8993ece6-a9e3-487e-8a8e-6725512b78a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ff03f80>]}
[0m15:51:38.356130 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m15:51:38.356919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8993ece6-a9e3-487e-8a8e-6725512b78a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa034aba0>]}
[0m15:51:38.358527 [info ] [MainThread]: 
[0m15:51:38.359991 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m15:51:38.364008 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m15:51:38.378178 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:39.169047 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m15:51:39.173800 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:51:39.182897 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m15:51:39.191760 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m15:51:39.211952 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m15:51:39.219292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8993ece6-a9e3-487e-8a8e-6725512b78a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b4e0c0>]}
[0m15:51:39.224805 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:39.229494 [info ] [MainThread]: 
[0m15:51:39.247215 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m15:51:39.248478 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m15:51:39.249633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m15:51:39.250292 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m15:51:39.256055 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m15:51:39.257508 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 15:51:39.250711 => 15:51:39.257262
[0m15:51:39.257994 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m15:51:39.301350 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m15:51:39.310611 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m15:51:39.317251 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m15:51:39.322331 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:51:39.325092 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m15:51:39.326341 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m15:51:39.352300 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m15:51:39.358758 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m15:51:39.364610 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:51:39.386969 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m15:51:39.389279 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m15:51:39.390822 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 15:51:39.258276 => 15:51:39.390614
[0m15:51:39.391760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8993ece6-a9e3-487e-8a8e-6725512b78a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90b118e0>]}
[0m15:51:39.392494 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.14s]
[0m15:51:39.393382 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m15:51:39.395417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:39.395937 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m15:51:39.396322 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m15:51:39.396833 [info ] [MainThread]: 
[0m15:51:39.397401 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m15:51:39.398257 [debug] [MainThread]: Command end result
[0m15:51:39.407864 [info ] [MainThread]: 
[0m15:51:39.408532 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:39.409061 [info ] [MainThread]: 
[0m15:51:39.409583 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:39.411272 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4259033, "process_user_time": 3.325939, "process_kernel_time": 0.468229, "process_mem_max_rss": "184448", "process_in_blocks": "42808", "process_out_blocks": "1735"}
[0m15:51:39.411874 [debug] [MainThread]: Command `dbt run` succeeded at 15:51:39.411762 after 1.43 seconds
[0m15:51:39.412319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0751bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff808e02f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa06b3470>]}
[0m15:51:39.412691 [debug] [MainThread]: Flushing usage events
[0m16:05:23.682676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1a9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f623650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f1a8410>]}


============================== 16:05:23.689881 | 8ceca5e0-0608-486d-898e-bbfd3eb3e858 ==============================
[0m16:05:23.689881 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:05:23.693304 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/project/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:05:23.846482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8ceca5e0-0608-486d-898e-bbfd3eb3e858', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f166e70>]}
[0m16:05:23.847453 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:05:23.849549 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:05:23.850684 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.19906616, "process_user_time": 2.820484, "process_kernel_time": 0.547452, "process_mem_max_rss": "102812", "process_in_blocks": "95864", "process_out_blocks": "3"}
[0m16:05:23.851237 [debug] [MainThread]: Command `dbt deps` succeeded at 16:05:23.851092 after 0.20 seconds
[0m16:05:23.851614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f623650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fd7f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f033740>]}
[0m16:05:23.852011 [debug] [MainThread]: Flushing usage events
[0m16:05:27.260817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53dda00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7120a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb53dc680>]}


============================== 16:05:27.267273 | a296092f-e54e-463e-8e66-41f2bc55435c ==============================
[0m16:05:27.267273 [info ] [MainThread]: Running with dbt=1.7.19
[0m16:05:27.271270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/project/dbt', 'log_path': '/opt/airflow/project/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select crypto_hourly_gainers', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:05:27.398129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a296092f-e54e-463e-8e66-41f2bc55435c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5bd0800>]}
[0m16:05:27.437627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a296092f-e54e-463e-8e66-41f2bc55435c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7120a40>]}
[0m16:05:27.438884 [info ] [MainThread]: Registered adapter: clickhouse=1.7.7
[0m16:05:27.448181 [debug] [MainThread]: checksum: a8d43cdff37d0f32d7fbe4c5c25bea4bb6c86e162f8ce8fdb1a38cdcf7495431, vars: {}, profile: , target: , version: 1.7.19
[0m16:05:27.476948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:05:27.477401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:05:27.481494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a296092f-e54e-463e-8e66-41f2bc55435c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb51df620>]}
[0m16:05:27.492559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a296092f-e54e-463e-8e66-41f2bc55435c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb50a7890>]}
[0m16:05:27.493010 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 429 macros, 0 groups, 0 semantic models
[0m16:05:27.493733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a296092f-e54e-463e-8e66-41f2bc55435c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5399ca0>]}
[0m16:05:27.494854 [info ] [MainThread]: 
[0m16:05:27.495656 [debug] [MainThread]: Acquiring new clickhouse connection 'master'
[0m16:05:27.496811 [debug] [ThreadPool]: Acquiring new clickhouse connection 'list_'
[0m16:05:27.504621 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:05:28.565245 [debug] [ThreadPool]: dbt_clickhouse adapter: On list_: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list_"} */

    select name from system.databases
  ...
[0m16:05:28.568585 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:05:28.572841 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_, now list__analytics)
[0m16:05:28.580541 [debug] [ThreadPool]: dbt_clickhouse adapter: On list__analytics: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "connection_name": "list__analytics"} */
select
      t.name as name,
      t.database as schema,
      multiIf(
        engine in ('MaterializedView', 'View'), 'view',
        engine = 'Dictionary', 'dictionary',
        'table'
      ) as type,
      db.engine as db_engine,0 as is_on_cluster
          from system.tables as t join system.databases as db on t.database = db.name
        where schema = 'analytics'
      

  ...
[0m16:05:28.598769 [debug] [ThreadPool]: dbt_clickhouse adapter: SQL status: OK in 0.02 seconds
[0m16:05:28.600832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a296092f-e54e-463e-8e66-41f2bc55435c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb42541a0>]}
[0m16:05:28.601890 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:05:28.606182 [info ] [MainThread]: 
[0m16:05:28.617552 [debug] [Thread-1 (]: Began running node model.crypto_dbt.crypto_hourly_gainers
[0m16:05:28.618188 [info ] [Thread-1 (]: 1 of 1 START sql table model `analytics`.`crypto_hourly_gainers` ............... [RUN]
[0m16:05:28.619027 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list__analytics, now model.crypto_dbt.crypto_hourly_gainers)
[0m16:05:28.619386 [debug] [Thread-1 (]: Began compiling node model.crypto_dbt.crypto_hourly_gainers
[0m16:05:28.623370 [debug] [Thread-1 (]: Writing injected SQL for node "model.crypto_dbt.crypto_hourly_gainers"
[0m16:05:28.624756 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (compile): 16:05:28.619662 => 16:05:28.624586
[0m16:05:28.625122 [debug] [Thread-1 (]: Began executing node model.crypto_dbt.crypto_hourly_gainers
[0m16:05:28.662790 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

            

    
        create table `analytics`.`crypto_hourly_gainers__dbt_backup`
        
  
        
  engine = MergeTree()
        
      order by (tuple())
        
        
        
        
                    -- end_of_sql
                    SETTINGS  replicated_deduplication_window=0

                    
            empty
          as (
            -- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
          )
        ...
[0m16:05:28.671007 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.01 seconds
[0m16:05:28.676615 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    select name, type from system.columns where table = 'crypto_hourly_gainers__dbt_backup'
    
      and database = 'analytics'
    
    order by position
  ...
[0m16:05:28.681069 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:05:28.683462 [debug] [Thread-1 (]: Writing runtime sql for node "model.crypto_dbt.crypto_hourly_gainers"
[0m16:05:28.684734 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

  
    
    
    
        
        insert into `analytics`.`crypto_hourly_gainers__dbt_backup`
        ("ts", "symbol", "pct_1h")-- hourly gainers (> 3% over last hour)
select
  ts,
  symbol,
  pct_1h
from analytics.hourly_prices
where pct_1h > 3
  ...
[0m16:05:28.711042 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.03 seconds
[0m16:05:28.714812 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */
EXCHANGE TABLES `analytics`.`crypto_hourly_gainers__dbt_backup` AND `analytics`.`crypto_hourly_gainers` 
  
  ...
[0m16:05:28.717366 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:05:28.739065 [debug] [Thread-1 (]: dbt_clickhouse adapter: On model.crypto_dbt.crypto_hourly_gainers: /* {"app": "dbt", "dbt_version": "1.7.19", "profile_name": "crypto_profile", "target_name": "dev", "node_id": "model.crypto_dbt.crypto_hourly_gainers"} */

    drop table if exists `analytics`.`crypto_hourly_gainers__dbt_backup` 
  ...
[0m16:05:28.743100 [debug] [Thread-1 (]: dbt_clickhouse adapter: SQL status: OK in 0.00 seconds
[0m16:05:28.749645 [debug] [Thread-1 (]: Timing info for model.crypto_dbt.crypto_hourly_gainers (execute): 16:05:28.625366 => 16:05:28.748875
[0m16:05:28.752124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a296092f-e54e-463e-8e66-41f2bc55435c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9643b290>]}
[0m16:05:28.754055 [info ] [Thread-1 (]: 1 of 1 OK created sql table model `analytics`.`crypto_hourly_gainers` .......... [[32mOK[0m in 0.13s]
[0m16:05:28.755861 [debug] [Thread-1 (]: Finished running node model.crypto_dbt.crypto_hourly_gainers
[0m16:05:28.758913 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:05:28.759623 [debug] [MainThread]: Connection 'model.crypto_dbt.crypto_hourly_gainers' was left open.
[0m16:05:28.760267 [debug] [MainThread]: On model.crypto_dbt.crypto_hourly_gainers: Close
[0m16:05:28.761309 [info ] [MainThread]: 
[0m16:05:28.762676 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.27 seconds (1.27s).
[0m16:05:28.764066 [debug] [MainThread]: Command end result
[0m16:05:28.775626 [info ] [MainThread]: 
[0m16:05:28.776297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:05:28.776747 [info ] [MainThread]: 
[0m16:05:28.777222 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:05:28.778854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5564538, "process_user_time": 3.146878, "process_kernel_time": 0.490631, "process_mem_max_rss": "184336", "process_in_blocks": "93056", "process_out_blocks": "1735"}
[0m16:05:28.779471 [debug] [MainThread]: Command `dbt run` succeeded at 16:05:28.779368 after 1.56 seconds
[0m16:05:28.779980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb63a3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5208c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5ac6ae0>]}
[0m16:05:28.780379 [debug] [MainThread]: Flushing usage events
